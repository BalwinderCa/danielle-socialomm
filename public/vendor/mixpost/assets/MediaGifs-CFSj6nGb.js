import{u as ue,Y as de,o as W,l as me,q as fe,p as X,a as Z}from"./app-D31ITXvg.js";import{r as C,b as A,w as ee,n as pe,k as a,l as k,J as te,x as v,y as M,C as p,t as J,aJ as z,f as T,b1 as ve,bN as j,E as c,ak as I,A as S,u as s,z as o,F as U,aO as se}from"./@vue-DxEuNGre.js";import{K as H,i as ae}from"./@inertiajs-D-tiTHlX.js";import{n as ge}from"./nanoid-DP16PUbO.js";import{_ as E}from"./Masonry-C9nPH5UC.js";import{_ as F}from"./MediaFile-CRJPtfzT.js";import{S as le}from"./SectionTitle-DlhdjqIe.js";import{l as oe}from"./lodash-1tNnn4nO.js";import{_ as ne}from"./SearchInput-C6so_1kI.js";import{_ as re}from"./NoResult-yipdih8U.js";import{_ as ie}from"./Alert-lYxJ5q5b.js";import{N as O}from"./nprogress-34pYfWsY.js";import{u as _e}from"./vue-i18n-CbxO4HOa.js";import{_ as he}from"./emoji-mart-vue-fast-DVezNdb5.js";const q=(u="mixpost.media.fetchUploads",b={})=>{const{t:y}=_e(),{notify:D}=ue(),d=C("uploads"),N=A(()=>["uploads","stock","gifs","healthinomics"]),r=C(!1),w=C(!1),g=C(!1),_=C(1),m=C([]),$=C(null),x=C(""),n=C([]),h=t=>{const e=n.value.findIndex(l=>l.id===t.id);e<0&&!t.hasOwnProperty("error")&&n.value.push(t),e>=0&&n.value.splice(e,1)},f=()=>{n.value=[]},P=t=>n.value.findIndex(l=>l.id===t.id)!==-1,i=(t=!0)=>{_.value&&(O.start(),axios.get(route(u,b),{params:{page:_.value,keyword:x.value}}).then(function(e){const l=e.data.links.next;l&&(_.value=e.data.links.next.split("?page=")[1]),l||(_.value=0),t||(m.value=e.data.data),t&&(m.value=[...m.value,...e.data.data])}).catch(()=>{D("error",y("media.error_retrieving_media"))}).finally(()=>{O.done(),r.value=!0}))},V=(t,e)=>{w.value=!0,O.start(),axios.post(route("mixpost.media.download",b),{items:t,from:d.value}).then(l=>{e(l)}).catch(()=>{D("error",y("media.error_downloading_media"))}).finally(()=>{w.value=!1,O.done(),O.remove()})},K=t=>{m.value=m.value.filter(e=>!t.includes(e.id))},L=t=>{let e="";return t.forEach(l=>{l.source==="Unsplash"&&(e+=`
Photo by ${l.author} on Unsplash`)}),e},Y=(t,e)=>{g.value=!0,O.start(),axios.delete(route("mixpost.media.delete",b),{data:{items:t}}).then(()=>{e()}).catch(()=>{D("error",y("media.error_deleting_media"))}).finally(()=>{g.value=!1,O.done(),O.remove()})},G=()=>{const t=new IntersectionObserver(e=>{e[0].isIntersecting&&i()});pe(()=>{t.observe($.value)})};return ee(x,oe.debounce(()=>{_.value=1,i(!1)},300)),{activeTab:d,tabs:N,isLoaded:r,isDownloading:w,isDeleting:g,keyword:x,page:_,items:m,endlessPagination:$,selected:n,getMediaCrediting:L,downloadExternal:V,deletePermanently:Y,removeItems:K,createObserver:G,toggleSelect:h,deselectAll:f,isSelected:P}},B={__name:"MediaSelectable",props:{active:{type:Boolean,default:!1}},emits:["click"],setup(u){return(b,y)=>(a(),k("div",{onClick:y[0]||(y[0]=D=>b.$emit("click")),class:"w-full relative cursor-pointer box-border"},[te(b.$slots,"default"),v("div",{class:J(["absolute flex items-center justify-center top-0 right-0 mr-md mt-md w-7 h-7 rounded-full border border-white",{"bg-primary-500":u.active,"bg-black bg-opacity-20":!u.active}])},[u.active?(a(),M(de,{key:0,class:"text-white"})):p("",!0)],2)]))}},ke={class:"relative flex flex-col justify-center"},be={class:"text-center mb-1"},ye={for:"browse",class:"cursor-pointer text-primary-500 hover:text-primary-700 active:text-primary-700 focus:outline-none focus:text-primary-700 transition-colors ease-in-out duration-200"},xe={class:"text-sm text-gray-400 text-center"},we=["accept"],$e={key:0,class:"mt-lg"},Ce={__name:"UploadMedia",props:{maxSelection:{type:Number,default:1},combinesMimeTypes:{type:String,default:""},selected:{type:Array,default:[]},toggleSelect:{type:Function},isSelected:{type:Function},columns:{type:Number,default:3}},emits:["mediaSelect"],setup(u,{emit:b}){const y=z("workspaceCtx"),D=u,d=H().props.mixpost.mime_types,N=C(null),r=C(!1),w=t=>{if(m.value)return;r.value=!1;const e=_(t.dataTransfer.files);e.length&&L(e)},g=t=>{const e=_(t.target.files);e.length&&(N.value.value=null,L(e))},_=t=>Array.from(t).filter(e=>d.includes(e.type)),m=C(!1),$=C([]),x=C([]),n=C({});ee(n,()=>{h(),m.value=Object.keys(n.value).length>0});const h=()=>{n.value.handler&&n.value.handler()},f=t=>{$.value.push(t),Object.keys(n.value).length===0&&P()},P=t=>{Object.keys(n.value).length>0&&(K(n.value,t),D.toggleSelect&&D.toggleSelect(t)),$.value.length>0?(i($.value[0]),V()):i({})},i=t=>{n.value=t},V=()=>{$.value.shift()},K=(t,e)=>{x.value.push(Object.assign(t,{media:e}))},L=t=>{t.forEach(e=>{f({id:ge(),handler:async()=>{await Y(e).then(l=>{P(l)}).catch(l=>{P({name:e.name,error:l.response.data.message})})}})})},Y=t=>{const e=new FormData;return e.append("file",t),new Promise((l,R)=>{axios.post(route("mixpost.media.upload",{workspace:y.id}),e).then(function(Q){l(Q.data)}).catch(function(Q){R(Q)})})},G=A(()=>x.value.filter(()=>!0).reverse());return T(()=>{W.on("mediaDelete",t=>{x.value=x.value.filter(e=>!t.includes(e.media.id))})}),ve(()=>{W.off("mediaDelete")}),(t,e)=>(a(),k(U,null,[v("div",{onDragenter:e[2]||(e[2]=j(l=>r.value=!m.value,["prevent"])),onDrop:j(w,["prevent"]),onDragover:e[3]||(e[3]=j(()=>{},["prevent"])),class:J([{"border-gray-700 bg-white":!r.value,"border-cyan-500 bg-cyan-50":r.value},"relative w-full flex items-center justify-center rounded-lg p-10 border-2 border-dashed transition-colors ease-in-out duration-200"])},[v("div",ke,[r.value?(a(),k("div",{key:0,onDragleave:e[0]||(e[0]=j(l=>r.value=!1,["prevent"])),onDragover:e[1]||(e[1]=j(()=>{},["prevent"])),class:"w-full h-full absolute"},null,32)):p("",!0),c(me,{class:J([{"text-stone-700":!r.value,"text-cyan-500":r.value},"!w-16 !h-16 mx-auto mb-xs transition-colors ease-in-out duration-200"])},null,8,["class"]),v("div",be,[I(S(t.$t("media.drag_drop_files"))+" ",1),v("label",ye,S(t.$t("general.browse")),1)]),v("div",xe,S(s(d).join(", ")),1)]),m.value?(a(),M(fe,{key:0,size:"xl",class:"rounded-lg"})):p("",!0)],34),v("input",{ref_key:"input",ref:N,id:"browse",type:"file",accept:s(d).join(","),multiple:"multiple",class:"hidden",onChange:g},null,40,we),G.value.length?(a(),k("div",$e,[c(E,{items:G.value,columns:u.columns},{default:o(({item:l})=>[c(B,{active:u.isSelected(l.media),onClick:R=>u.toggleSelect(l.media)},{default:o(()=>[c(F,{media:l.media},null,8,["media"])]),_:2},1032,["active","onClick"])]),_:1},8,["items","columns"])])):p("",!0)],64))}},Re={__name:"MediaUploads",props:{columns:{type:Number,default:3}},setup(u,{expose:b}){const y=z("workspaceCtx"),{page:D,items:d,endlessPagination:N,selected:r,toggleSelect:w,deselectAll:g,removeItems:_,isSelected:m,createObserver:$}=q("mixpost.media.fetchUploads",{workspace:y.id});return T(()=>{$()}),b({selected:r,deselectAll:g,removeItems:_}),(x,n)=>(a(),k(U,null,[c(Ce,{"max-selection":4,"combines-mime-types":"",selected:s(r),toggleSelect:s(w),isSelected:s(m),columns:u.columns},null,8,["selected","toggleSelect","isSelected","columns"]),v("div",{class:J({"mt-lg":s(d).length})},[s(d).length?(a(),k(U,{key:0},[c(le,{class:"mb-4"},{default:o(()=>[I(S(x.$t("media.library")),1)]),_:1}),c(E,{items:s(d),columns:u.columns},{default:o(({item:h})=>[h?(a(),M(B,{key:0,active:s(m)(h),onClick:f=>s(w)(h)},{default:o(()=>[c(F,{media:h},null,8,["media"])]),_:2},1032,["active","onClick"])):p("",!0)]),_:1},8,["items","columns"])],64)):p("",!0),v("div",{ref_key:"endlessPagination",ref:N,class:"-z-10 w-full"},null,512)],2)],64))}},We={__name:"Healthinomics",props:{columns:{type:Number,default:3}},setup(u,{expose:b}){const y=z("workspaceCtx"),{page:D,items:d,endlessPagination:N,selected:r,toggleSelect:w,deselectAll:g,removeItems:_,isSelected:m,createObserver:$}=q("mixpost.media.fetchMedia",{workspace:y.id});return T(()=>{$()}),b({selected:r,deselectAll:g,removeItems:_}),(x,n)=>(a(),k("div",{class:J({"mt-lg":s(d).length})},[n[0]||(n[0]=v("div",{class:"mb-4 text-primary-500 flex items-center border-b-2 border-gray-200 pb-xs mr-md rtl:mr-0 rtl:ml-md last:mr-0 rtl:last:ml-0 font-medium transition-colors ease-in-out duration-200"},[v("a",{href:"https://www.healthinomics.com/",target:"_blank",rel:"noopener noreferrer"}," Visit Healthinomics ")],-1)),s(d).length?(a(),k(U,{key:0},[c(le,{class:"mb-4"},{default:o(()=>[I(S(x.$t("media.healthnomics_library")),1)]),_:1}),c(E,{items:s(d),columns:u.columns},{default:o(({item:h})=>[h?(a(),M(B,{key:0,active:s(m)(h),onClick:f=>s(w)(h)},{default:o(()=>[c(F,{media:h},null,8,["media"])]),_:2},1032,["active","onClick"])):p("",!0)]),_:1},8,["items","columns"])],64)):p("",!0),v("div",{ref_key:"endlessPagination",ref:N,class:"-z-10 w-full"},null,512)],2))}},Se={},Ne={class:"absolute z-10 bottom-0 mb-xs left-0 ml-xs hidden group-hover:block shadow-mix"},De={class:"bg-white shadow-mix py-xs px-sm text-left rounded-md"};function Ie(u,b){return a(),k("div",Ne,[v("div",De,[te(u.$slots,"default")])])}const ce=he(Se,[["render",Ie]]),Pe={key:0},Me={key:0,class:"mt-lg"},Oe=["href"],Ue=["href"],Xe={__name:"MediaStock",props:{columns:{type:Number,default:3}},setup(u,{expose:b}){const y=z("workspaceCtx"),{user:D}=X(),d=A(()=>oe.snakeCase(H().props.app.name)),N=A(()=>H().props.is_configured_service.unsplash),{isLoaded:r,keyword:w,items:g,endlessPagination:_,selected:m,toggleSelect:$,deselectAll:x,isSelected:n,createObserver:h}=q("mixpost.media.fetchStock",{workspace:y.id});return T(()=>{N.value&&h()}),b({selected:m,deselectAll:x}),(f,P)=>(a(),k(U,null,[N.value?(a(),k("div",Pe,[c(ne,{modelValue:s(w),"onUpdate:modelValue":P[0]||(P[0]=i=>se(w)?w.value=i:null),placeholder:f.$t("service.unsplash.search")},null,8,["modelValue","placeholder"]),s(g).length?(a(),k("div",Me,[c(E,{items:s(g),columns:u.columns},{default:o(({item:i})=>[i?(a(),M(B,{key:0,active:s(n)(i),onClick:V=>s($)(i)},{default:o(()=>[c(F,{media:i,class:"group"},{default:o(()=>[c(ce,null,{default:o(()=>[v("div",null,[I(S(f.$t("media.image_source"))+": ",1),v("a",{href:`https://unsplash.com/?utm_source=${d.value}&utm_medium=referral`,target:"_blank",class:"link"},"Unsplash",8,Oe)]),v("div",null,[I(S(f.$t("media.author"))+": ",1),v("a",{href:`${i.credit_url}?utm_source=${d.value}&utm_medium=referral`,target:"_blank",class:"link"},S(i.name),9,Ue)])]),_:2},1024)]),_:2},1032,["media"])]),_:2},1032,["active","onClick"])):p("",!0)]),_:1},8,["items","columns"])])):p("",!0),s(r)&&!s(g).length?(a(),M(re,{key:1,class:"mt-lg"},{default:o(()=>[I(S(f.$t("media.no_images_found")),1)]),_:1})):p("",!0),v("div",{ref_key:"endlessPagination",ref:_,class:"-z-10 w-full"},null,512)])):p("",!0),N.value?p("",!0):(a(),k(U,{key:1},[c(ie,{variant:"warning",closeable:!1},{default:o(()=>[I(S(f.$t("service.not_configured_service",{service:"Unsplash"})),1)]),_:1}),s(D).is_admin?(a(),M(s(ae),{key:0,href:f.route("mixpost.services.index"),class:"block mt-md"},{default:o(()=>[c(Z,null,{default:o(()=>[I(S(f.$t("media.click_configure")),1)]),_:1})]),_:1},8,["href"])):p("",!0)],64))],64))}},Ve={key:0},je={key:0,class:"mt-lg"},Ze={__name:"MediaGifs",props:{columns:{type:Number,default:3}},setup(u,{expose:b}){const y=z("workspaceCtx"),{user:D}=X(),d=A(()=>H().props.is_configured_service.tenor),{isLoaded:N,keyword:r,page:w,items:g,endlessPagination:_,selected:m,toggleSelect:$,deselectAll:x,isSelected:n,createObserver:h}=q("mixpost.media.fetchGifs",{workspace:y.id});return T(()=>{d.value&&h()}),b({selected:m,deselectAll:x}),(f,P)=>(a(),k(U,null,[d.value?(a(),k("div",Ve,[c(ne,{modelValue:s(r),"onUpdate:modelValue":P[0]||(P[0]=i=>se(r)?r.value=i:null),placeholder:f.$t("service.tenor.search_gifs")},null,8,["modelValue","placeholder"]),s(g).length?(a(),k("div",je,[c(E,{items:s(g),columns:u.columns},{default:o(({item:i})=>[i?(a(),M(B,{key:0,active:s(n)(i),onClick:V=>s($)(i)},{default:o(()=>[(a(),M(F,{media:i,key:i.id,class:"group"},{default:o(()=>[c(ce,null,{default:o(()=>[I(S(f.$t("service.tenor.gif")),1)]),_:1})]),_:2},1032,["media"]))]),_:2},1032,["active","onClick"])):p("",!0)]),_:1},8,["items","columns"])])):p("",!0),s(N)&&!s(g).length?(a(),M(re,{key:1,class:"mt-lg"},{default:o(()=>[I(S(f.$t("media.no_gifs_found")),1)]),_:1})):p("",!0),v("div",{ref_key:"endlessPagination",ref:_,class:"-z-10 w-full"},null,512)])):p("",!0),d.value?p("",!0):(a(),k(U,{key:1},[c(ie,{variant:"warning",closeable:!1},{default:o(()=>[I(S(f.$t("service.not_configured_service",{service:"Tenor"})),1)]),_:1}),s(D).is_admin?(a(),M(s(ae),{key:0,href:f.route("mixpost.services.index"),class:"block mt-md"},{default:o(()=>[c(Z,null,{default:o(()=>[I(S(f.$t("media.click_configure")),1)]),_:1})]),_:1},8,["href"])):p("",!0)],64))],64))}};export{Re as _,Xe as a,Ze as b,We as c,q as u};
