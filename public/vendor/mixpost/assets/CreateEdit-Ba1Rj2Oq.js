const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AIAssist-VH7FGqEv.js","assets/VariableManager-CgO8ohDb.js","assets/@tiptap-DlxRGiDd.js","assets/@vue-DxEuNGre.js","assets/prosemirror-state-Dfkm3xtq.js","assets/prosemirror-model-C-VrLeHJ.js","assets/orderedmap-C4TimWWB.js","assets/prosemirror-transform-CNTRfHZy.js","assets/prosemirror-dropcursor-CRVdsyHs.js","assets/prosemirror-gapcursor-CIClWOe5.js","assets/prosemirror-keymap-BrtsOOc5.js","assets/w3c-keyname-DEtA-KhA.js","assets/prosemirror-view-CARpBv5D.js","assets/prosemirror-history-C8_5KGmB.js","assets/rope-sequence-Cxv9J64N.js","assets/linkifyjs-CkylhtGF.js","assets/prosemirror-commands-B8A7CEu7.js","assets/prosemirror-schema-list-B_jBki9Q.js","assets/vue-i18n-CbxO4HOa.js","assets/@intlify-AYDeHhOU.js","assets/Variable-BeQHY_FA.js","assets/app-CbUEMLPN.js","assets/axios-CCb-kr4I.js","assets/floating-vue-BgCeCz-J.js","assets/@floating-ui-Dq8c3VDt.js","assets/floating-vue-DF4AVo2i.css","assets/vue-select-CUmyCPba.js","assets/vue-select-DARUaxu_.css","assets/@inertiajs-D-tiTHlX.js","assets/deepmerge-CaivEIYs.js","assets/@babel-DR_DpGdq.js","assets/qs-rEl07COy.js","assets/side-channel-BRnl5gSA.js","assets/get-intrinsic-Cc4ufvoy.js","assets/has-symbols-eVqrYdw7.js","assets/function-bind-CTBxUF5L.js","assets/has-0xLfSV6H.js","assets/call-bind-BYlQD6Li.js","assets/object-inspect-DHD9wu3Y.js","assets/nprogress-34pYfWsY.js","assets/lodash.clonedeep-DcFMYim1.js","assets/lodash.isequal-K_gfpr-R.js","assets/laravel-vite-plugin-DEL3ZhID.js","assets/emoji-mart-vue-fast-DVezNdb5.js","assets/emoji-mart-vue-fast-CIKiYTla.css","assets/lodash-1tNnn4nO.js","assets/mitt-DJ65BbbF.js","assets/date-fns-tz-NX4xHF3p.js","assets/date-fns-Uop7x9nl.js","assets/pusher-js-CH5STpCs.js","assets/laravel-echo-C9ppFO4I.js","assets/app-Ba-KQXuu.css","assets/app-Cv6p9Oh4.css","assets/MediaGifs-DLgmobVH.js","assets/nanoid-DP16PUbO.js","assets/Masonry-CuIrbeOx.js","assets/MediaFile-CRJPtfzT.js","assets/ExclamationCircle-Co8IAwQh.js","assets/SectionTitle-DlhdjqIe.js","assets/SearchInput-Dj1Ll7ir.js","assets/NoResult-CBoUxwWZ.js","assets/Alert-Bclh1Zq3.js","assets/Tab-gMbHW_qz.js","assets/vuedraggable-OGJnKJQC.js","assets/vue-CveCyDR3.js","assets/sortablejs-DNSymPwa.js","assets/EllipsisVertical-DX5Zf3Qx.js","assets/Trash-CGBHVq5p.js","assets/ListItem-CZIJw31K.js","assets/Textarea-XqA1xqrh.js","assets/VerticalGroup-0ogbRp0b.js","assets/Flex-55yEXw9x.js","assets/useAPIForm-Cr7Lz7eJ.js","assets/Select-BOKsQWfr.js","assets/Refresh-BG68H2OY.js","assets/ClipboardButton-B2BonkK8.js","assets/Clipboard-szG3aGAU.js"])))=>i.map(i=>d[i]);
import{T as kt,K as et,i as Gt,O as ye,Z as Kt}from"./@inertiajs-D-tiTHlX.js";import{l as K}from"./lodash-1tNnn4nO.js";import{r as W,f as ae,aJ as X,b as z,s as $t,b1 as tt,b8 as Le,k as a,l as y,x as h,E as o,z as n,F as G,q as oe,y as S,t as re,C as I,G as _e,ak as L,A as u,bN as wt,u as l,w as ne,o as Ee,J as he,al as bt,n as ce,I as Qt,D as xt,B as Jt,a4 as Xt,a as es,p as ts,a1 as ss}from"./@vue-DxEuNGre.js";import{u as Ue,E as Ct,_ as os,a as pt,b as st,c as ns,d as is,e as rs,S as as,f as ls}from"./VariableManager-CgO8ohDb.js";import{u as ge}from"./usePostVersions-THbIEc6s.js";import{a7 as cs,N as Tt,o as ve,a8 as ds,X as ot,k as De,g as ke,P as Vt,j as we,c as le,d as us,J as At,h as Ve,e as ms,a as pe,i as Oe,u as be,_ as Ne,Z as Lt,q as Fe,m as Et,a9 as vt,aa as ps,n as It,t as Pt,f as St,ab as vs,a6 as fs,ac as We,C as _s,$ as hs,a0 as gs,U as ys,ad as ks,r as nt,p as $s,Q as ws}from"./app-CbUEMLPN.js";import{u as it}from"./useSettings-zxwQ4_xc.js";import{_ as bs}from"./PageHeader-5KlQKxZu.js";import{u as de}from"./vue-i18n-CbxO4HOa.js";import{u as Be}from"./Variable-BeQHY_FA.js";import{_ as xs}from"./Panel-C3_mBW3b.js";import{_ as Mt}from"./Account-C5Qt61qv.js";import{_ as rt}from"./ProviderIcon-2Uv5mSMq.js";import{_ as Ke,T as Ut}from"./Tab-gMbHW_qz.js";import{b as Cs,u as Ts,C as Dt,d as ft,c as Ye,N as Vs,S as As,a as Ls,_ as Es}from"./VerticallyScrollableContent-DghZt4Ub.js";import{p as Is}from"./twemoji-parser-B5YFQwC8.js";import{e as Ps,T as Ss}from"./twitter-text-DIuyUgD4.js";import{_ as Ae}from"./Radio-DGi8giFl.js";import{_ as qe}from"./Select-BOKsQWfr.js";import{_ as $e}from"./Label-DG40Yk9a.js";import{_ as Qe}from"./LabelSuffix-Di2RYCr8.js";import{_ as at}from"./VerticalGroup-0ogbRp0b.js";import{_ as Te}from"./Checkbox-CdCvF_Az.js";import{_ as ue}from"./emoji-mart-vue-fast-DVezNdb5.js";import{_ as Me}from"./Alert-Bclh1Zq3.js";import{_ as Ms}from"./Switch-DhFwAO3J.js";import{_ as se}from"./Flex-55yEXw9x.js";import{N as me}from"./nprogress-34pYfWsY.js";import{E as Us}from"./EllipsisVertical-DX5Zf3Qx.js";import{T as Ot}from"./Trash-CGBHVq5p.js";import{L as lt,_ as ct}from"./ListItem-CZIJw31K.js";import{_ as Ft}from"./NoResult-CBoUxwWZ.js";import{_ as Ds}from"./TemplateItem-CLcOfy1G.js";import{_ as Os}from"./Masonry-CuIrbeOx.js";import{_ as Fs}from"./EditorReadOnly-ba88YiRs.js";import{C as Bs}from"./ChevronDown-CD-zlGXi.js";import{d as qs}from"./date-fns-tz-NX4xHF3p.js";import{E as Rs}from"./ExclamationCircle-Co8IAwQh.js";import{F as _t}from"./vue-flatpickr-component-B17rGV5K.js";import"./flatpickr-BZlGG09B.js";import{a as zs,z as js,p as Bt}from"./date-fns-Uop7x9nl.js";import{_ as Hs}from"./SuccessButton-C0gY5W6u.js";import{E as Ns}from"./Eye-Bm2KpbsG.js";import{u as qt}from"./useAPIForm-Cr7Lz7eJ.js";import{_ as Ws}from"./DropdownButton-BbrhX0gq.js";import{e as Ys,u as Zs,H as Gs,f as Ks,P as Qs,g as Js,h as Xs,a as eo}from"./@tiptap-DlxRGiDd.js";import{t as to}from"./tippy.js-oaMRTIk4.js";import{A as so}from"./ArrowLeft-BKyFr17y.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CaivEIYs.js";import"./@babel-DR_DpGdq.js";import"./qs-rEl07COy.js";import"./side-channel-BRnl5gSA.js";import"./get-intrinsic-Cc4ufvoy.js";import"./has-symbols-eVqrYdw7.js";import"./function-bind-CTBxUF5L.js";import"./has-0xLfSV6H.js";import"./call-bind-BYlQD6Li.js";import"./object-inspect-DHD9wu3Y.js";import"./lodash.clonedeep-DcFMYim1.js";import"./lodash.isequal-K_gfpr-R.js";import"./prosemirror-state-Dfkm3xtq.js";import"./prosemirror-model-C-VrLeHJ.js";import"./orderedmap-C4TimWWB.js";import"./prosemirror-transform-CNTRfHZy.js";import"./MediaGifs-DLgmobVH.js";import"./nanoid-DP16PUbO.js";import"./MediaFile-CRJPtfzT.js";import"./SectionTitle-DlhdjqIe.js";import"./SearchInput-Dj1Ll7ir.js";import"./vuedraggable-OGJnKJQC.js";import"./vue-CveCyDR3.js";import"./sortablejs-DNSymPwa.js";import"./Textarea-XqA1xqrh.js";/* empty css            */import"./floating-vue-BgCeCz-J.js";import"./@floating-ui-Dq8c3VDt.js";import"./vue-select-CUmyCPba.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./mitt-DJ65BbbF.js";import"./pusher-js-CH5STpCs.js";import"./laravel-echo-C9ppFO4I.js";import"./@intlify-AYDeHhOU.js";import"./prosemirror-view-CARpBv5D.js";import"./Refresh-BG68H2OY.js";import"./ArrowTopRightOnSquare-BBcEejN-.js";import"./ColorPicker-xuIygEbo.js";import"./@jaames-DqG6q-J1.js";import"./punycode-CpXYjh1u.js";import"./prosemirror-dropcursor-CRVdsyHs.js";import"./prosemirror-gapcursor-CIClWOe5.js";import"./prosemirror-keymap-BrtsOOc5.js";import"./w3c-keyname-DEtA-KhA.js";import"./prosemirror-history-C8_5KGmB.js";import"./rope-sequence-Cxv9J64N.js";import"./linkifyjs-CkylhtGF.js";import"./prosemirror-commands-B8A7CEu7.js";import"./prosemirror-schema-list-B_jBki9Q.js";import"./@popperjs-CvwSYPO-.js";const oo=()=>{const e=W(!1);return ae(()=>{e.value=!0}),{isMounted:e}},Ie=({context:e})=>{const t=X("routePrefix"),s="default",r="thread",i=z(()=>e.activity.thread.parent_comment===null?s:r),p=z(()=>i.value===r),_=z(()=>e.activity.thread.parent_comment),f=w=>{e.activity.thread.parent_comment=w},c=({view:w,id:P})=>e.activity[w].items.find(B=>B.id===P),$=({view:w,activity:P})=>{e.activity[w].items.push(P)},m=({view:w,id:P})=>{const B=e.activity[w].items.findIndex(j=>j.id===P);B>-1&&e.activity[w].items.splice(B,1)},k=({view:w,items:P})=>{e.activity[w].items=P},E=({view:w})=>e.activity[w].items,A=({view:w})=>e.activity[w].items.length,M=({view:w})=>e.activity[w].isInitialized,C=({view:w,state:P})=>{e.activity[w].isInitialized=P};return{VIEW_DEFAULT:s,VIEW_THREAD:r,currentView:i,isThreadView:p,threadParentComment:_,setThreadParentComment:f,getItem:c,addItem:$,removeItem:m,setItems:k,getItems:E,getItemsCount:A,getInitialized:M,setInitialized:C,getLastScrollPosition:({view:w})=>e.activity[w].scrollPosition,setLastScrollPosition:({view:w,state:P})=>{e.activity[w].scrollPosition=P},getThreadParentItem:()=>e.activity.thread.parent_comment,getDraftCommentText:({view:w})=>e.activity[w].text,setNewCommentText:({view:w,text:P})=>{e.activity[w].text=P},destroyThread:()=>{e.activity.thread.items=[],e.activity.thread.parent_comment=null,e.activity.thread.scrollPosition=0,e.activity.thread.text=""},fetchDefaultItems:w=>new Promise((P,B)=>{axios.get(route(`${t}.posts.activities.index`,w)).then(function(j){k({view:s,items:j.data.data}),C({view:s,state:!0}),P(j)}).catch(B)}),fetchThreadItems:w=>new Promise((P,B)=>{axios.get(route(`${t}.posts.comments.children`,w)).then(function(j){k({view:r,items:j.data.data}),C({view:r,state:!0}),P(j)}).catch(j=>B(j))})}},no=({props:e,context:t})=>{const{timeZone:s,timeFormat:r}=it(),{connectBroadcastPrivate:i,leaveBroadcastChannel:p}=cs(),{translatedFormat:_}=Tt(),{VIEW_DEFAULT:f,VIEW_THREAD:c,currentView:$,threadParentComment:m,getItem:k,addItem:E,removeItem:A,destroyThread:M}=Ie({context:t}),C=$t(null),T=b=>{const{zonedDateTime:x,format:v}=ds(b,s,r);return _(x,v)},V=()=>{const b=x=>x.is_child?c:f;C.value&&(C.value.listen("Post.PostActivityCreated",x=>{const v=b(x);!t.activity[v].isInitialized||$.value===f&&x.is_child||(x.timestamps.localized.created_at=T(x.timestamps.Iso8601.created_at),Object.keys(x.date_times).forEach(g=>{const w=x.date_times[g];x.date_times[g].localized=T(w.Iso8601)}),k({view:v,id:x.id}))||(E({view:v,activity:x}),ve.emit("postActivityCreated"))}),C.value.listen("Post.PostCommentUpdated",x=>{const v=b(x);if(!t.activity[v].isInitialized)return;const{id:O,text:g,children_count:w}=x,P=k({view:v,id:O});P&&(P.text=g),P.children_count=w}),C.value.listen("Post.PostCommentReactionsUpdated",x=>{const v=b(x);if(!t.activity[v].isInitialized)return;const{id:O,reactions:g}=x,w=k({view:v,id:O});w&&(w.reactions=g)}),C.value.listen("Post.PostCommentDeleted",x=>{const{id:v}=x;A({view:f,id:v}),A({view:c,id:v}),m.value&&m.value.id===v&&M()}))},d=()=>{e.post&&(C.value||(C.value=i(`mixpost_posts.${e.post.id}`),V()))};return ae(()=>{d()}),tt(()=>{e.post&&p(`mixpost_posts.${e.post.id}`)}),{connectToBroadcast:d}},io=()=>{const e=W(!1),t=()=>{e.value=!0},s=()=>{e.value=!1};return ae(()=>{window.addEventListener("offline",t),window.addEventListener("online",s)}),tt(()=>{window.removeEventListener("offline",t),window.removeEventListener("online",s)}),{offline:e,setOffline:t,setOnline:s}},ro={class:"flex flex-wrap items-start"},ao={key:1,class:"mr-xs"},lo={key:2,class:"mr-xs"},co={key:3,class:"absolute hidden group-hover:flex items-center top-0 right-0 pb-2 pl-0.5 h-full bg-white"},uo=["onClick"],mo={class:"font-semibold"},po={class:"mr-xs"},vo={class:"text-left"},fo={key:0},_o={__name:"PostVersionsTab",props:{versions:{required:!0,type:Array},activeVersion:{type:[Number,null],default:null},accounts:{required:!0,type:Array},selectedAccounts:{required:!0,type:Array}},emits:["add","remove","select"],setup(e,{emit:t}){const{t:s}=de(),r=e,i=t,{editAllowed:p}=Ue(),_=z(()=>r.accounts.filter(A=>r.selectedAccounts.includes(A.id)&&!r.versions.map(M=>M.account_id).includes(A.id))),f=z(()=>_.value.map(A=>`${A.name}(${A.provider})`).join(`
`)),{getOriginalVersion:c}=ge(),$=z(()=>{const A={...c(r.versions),account:{name:s("post.original")}},M=r.versions.map(C=>{const T=r.accounts.find(V=>V.id===C.account_id);return T!==void 0?{...C,account:T}:null}).filter(C=>C);return[A,...M]}),m=W(null),k=()=>{m.value=null},E=()=>{i("remove",m.value.account_id),k()};return(A,M)=>{const C=Le("tooltip");return a(),y("div",null,[h("div",ro,[o(Ut,{class:"mr-xs items-center"},{default:n(()=>[(a(!0),y(G,null,oe($.value,(T,V)=>(a(),S(Ke,{key:T.account_id,onClick:d=>A.$emit("select",T.account_id),active:e.activeVersion===T.account_id,"tab-index":V,class:"relative mb-xs group"},{default:n(()=>[T.is_original?I("",!0):(a(),S(rt,{key:0,provider:T.account.provider,class:re([["!w-4","!h-4"],"mr-xs"])},null,8,["provider"])),T.is_original&&f.value?_e((a(),y("span",ao,[L(u(T.account.name),1)])),[[C,f.value]]):(a(),y("span",lo,u(T.account.name),1)),T.is_original?I("",!0):(a(),y("div",co,[h("button",{onClick:wt(d=>m.value=T,["prevent","stop"]),class:"inline-flex text-gray-300 group-hover:text-gray-500 hover:!text-red-500 transition-colors ease-in-out duration-200"},[o(ot,{class:"!w-4 !h-4"})],8,uo)]))]),_:2},1032,["onClick","active","tab-index"]))),128)),l(p)&&_.value.length>1?(a(),S(De,{key:0,"width-classes":"w-64"},{trigger:n(()=>[_e((a(),S(ke,null,{default:n(()=>[o(Vt)]),_:1})),[[C,l(s)("post.create_version")]])]),header:n(()=>[h("div",mo,u(l(s)("post.create_version_for")),1)]),content:n(()=>[o(Cs,{"max-height":"xl"},{default:n(()=>[(a(!0),y(G,null,oe(_.value,T=>(a(),S(we,{key:T.id,onClick:V=>A.$emit("add",T.id),as:"button"},{default:n(()=>[h("span",po,[o(Mt,{provider:T.provider,name:T.name,"img-url":T.image,active:!0},null,8,["provider","name","img-url"])]),h("span",vo,u(T.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):I("",!0)]),_:1})]),o(At,{show:m.value!==null,onClose:k,variant:"danger"},{header:n(()=>[L(u(l(s)("post.remove_version")),1)]),body:n(()=>[m.value?(a(),y("span",fo,u(l(s)("post.confirmation_delete_version",{account_name:m.value.account.name,account_provider:m.value.account.provider})),1)):I("",!0)]),footer:n(()=>[o(le,{onClick:k,class:"mr-xs"},{default:n(()=>[L(u(l(s)("general.cancel")),1)]),_:1}),o(us,{onClick:E},{default:n(()=>[L(u(l(s)("general.remove")),1)]),_:1})]),_:1},8,["show"])])}}},ho=(e,t=[])=>{const s={urlWeight:null,emojiWeight:2,...t};if(typeof e!="string")throw new TypeError("Invalid input: text must be a string.");const r=e.split("");let i=0;const p=s.urlWeight?Ps(e):[],_=s.emojiWeight?go(Is(e)):[],f=/[^\u0009-\u000D\u0020-\uFFFF]/u;for(let c=0;c<r.length;c++){const $=r[c];if(!f.test($))if(s.urlWeight&&p[c]){const m=p[c],k=m.url;i+=s.urlWeight,c+=k.length-1}else if(s.emojiWeight&&_[c]){const m=_[c],k=m.text;i+=s.emojiWeight,c+=k.length-1}else i+=1}return i},go=e=>e.reduce(function(t,s){return t[s.indices[0]]=s,t},{}),dt={getLength:ho},yo=e=>{const t=e.replace(/(@[^@\s]+)@[\w.-]+/g,"$1");return dt.getLength(t,{urlWeight:23,emojiWeight:1})},ko={getPostLength:yo},$o=e=>{try{const t=new URL(e);if(t.protocol!=="http:"&&t.protocol!=="https:")return e;const s=(t.pathname==="/"?"":t.pathname)+t.search+t.hash;return s.length>15?t.host+s.slice(0,13)+"...":t.host+s}catch{return e}},wo=e=>{const t=e.replace(/https?:\/\/[^\s]+/g,s=>$o(s));return dt.getLength(t,{urlWeight:null,emojiWeight:1})},bo={getPostLength:wo};function ut(e){const{accountHasVersion:t}=ge(),{getTextFromHtmlString:s}=Be(),r=z(()=>e.selectedAccounts.filter(C=>!t(e.versions,C.id))),i=(C,T,V)=>{const d=V.post_configs.text_char_limit[C];return d[T]||d.default},p=(C,T,V)=>{if(!e.selectedAccounts.length)return null;const d=e.versions.find(v=>v.account_id===C),x=(C===0?r.value:e.selectedAccounts.filter(v=>v.id===C)).map(v=>{var g;const O=((g=d==null?void 0:d.options[v.provider])==null?void 0:g.type)||"default";return{account_id:v.id,provider:{id:v.provider,name:v.provider_name},limit:i(T,O,v)}});return x.length?V(x,"limit"):null},_=C=>p(C,"max",K.minBy)||null,f=C=>p(C,"min",K.maxBy)||null,c=(C,T)=>{switch(C){case"mastodon":return ko.getPostLength(T);case"bluesky":return bo.getPostLength(T);case"twitter":return Ss.getTweetLength(T);default:return dt.getLength(T)}},$=(C,T)=>C-T,m=C=>{var V;const T=e.versions.find(({account_id:d})=>d===C);return((V=T==null?void 0:T.content[e.activeContent])==null?void 0:V.body)||""},k=z(()=>_(e.activeVersion)),E=z(()=>f(e.activeVersion)),A=z(()=>{var C;return c((C=k.value)==null?void 0:C.provider.id,s(m(e.activeVersion)))}),M=z(()=>{var C,T;return(C=k.value)!=null&&C.limit?$((T=k.value)==null?void 0:T.limit,A.value):null});return{currentCharMaxLimit:k,currentCharMinLimit:E,currentCharUsed:A,currentCharLeft:M,getCharLimitForType:i,getCharMaxLimit:_,getCharMinLimit:f,getTextLength:c,calculateCharLeft:$}}const xo={key:0,class:"flex items-center justify-center"},Co={__name:"PostCharacterCount",props:{selectedAccounts:{type:Array,required:!0},versions:{type:Array,required:!0},activeVersion:{type:Number,required:!0},activeContent:{type:Number,required:!0}},emits:["updateMaxCharLimit"],setup(e,{emit:t}){const s=e,r=t,{currentCharLeft:i,currentCharMaxLimit:p,getCharMaxLimit:_}=ut(s),f=()=>{var c;r("updateMaxCharLimit",((c=_(s.activeVersion))==null?void 0:c.limit)||0)};return ne(i,K.debounce(()=>{p.value&&r("updateMaxCharLimit",p.value.limit||0)},100)),ne(()=>s.versions.length,f),ne(()=>s.selectedAccounts,f),ae(()=>{ve.on("postVersionContentDeleted",()=>{f()}),f()}),Ee(()=>{ve.off("postVersionContentDeleted")}),(c,$)=>l(i)!==null?(a(),y("div",xo,[h("div",{class:re({"text-stone-800":l(i)>=0,"text-orange-500":l(i)*100/l(p).limit<20,"text-red-500":l(i)<0})},u(l(i)),3)])):I("",!0)}},To={class:"border border-gray-200 p-md rounded-lg"},Vo={class:"flex items-center mb-md"},xe={__name:"ProviderOptionWrap",props:{provider:{type:String,required:!0},title:{type:String,required:!0}},setup(e){return(t,s)=>(a(),y("div",To,[h("div",Vo,[o(rt,{provider:e.provider,class:"mr-xs"},null,8,["provider"]),h("span",null,u(e.title),1)]),he(t.$slots,"default")]))}},Ao=()=>{const{getAccountVersion:e}=ge(),t=W(!1),s=W(!1);return{postTypeDisabled:t,postReelDisabled:s,validatePostType:({options:i,activeVersion:p,versions:_})=>{const f=e(_,p);if(!f)return;const c=f.content.some(m=>m.media.some(k=>k.is_video===!0));if(f.content.some(m=>m.media.some(k=>k.is_video===!1))){s.value=!0,t.value=!1,i.type==="reel"&&(i.type="post");return}if(c){s.value=!1,t.value=!0,i.type==="post"&&(i.type="reel");return}s.value=!1,t.value=!1}}},Lo={class:"flex items-center space-x-sm"},Eo={__name:"InstagramOptions",props:["options","activeVersion","versions"],setup(e){const t=e,{postTypeDisabled:s,postReelDisabled:r,validatePostType:i}=Ao(),p=()=>{i({options:t.options,activeVersion:t.activeVersion,versions:t.versions})};return ne(t.versions,p),ae(p),(_,f)=>(a(),S(xe,{title:_.$t("service.provider_options",{provider:"Instagram"}),provider:"instagram"},{default:n(()=>[h("div",null,[h("div",Lo,[h("label",null,[o(Ae,{checked:e.options.type,"onUpdate:checked":f[0]||(f[0]=c=>e.options.type=c),disabled:l(s),value:"post"},null,8,["checked","disabled"]),L(" "+u(_.$t("service.meta.post")),1)]),h("label",null,[o(Ae,{checked:e.options.type,"onUpdate:checked":f[1]||(f[1]=c=>e.options.type=c),disabled:l(r),value:"reel"},null,8,["checked","disabled"]),L(" "+u(_.$t("service.meta.reel")),1)]),h("label",null,[o(Ae,{checked:e.options.type,"onUpdate:checked":f[2]||(f[2]=c=>e.options.type=c),value:"story"},null,8,["checked"]),L(" "+u(_.$t("service.meta.story")),1)])])])]),_:1},8,["title"]))}},Io={class:"w-full mb-xs"},Po={class:"w-full"},So={value:"public"},Mo={value:"private"},Uo={value:"unlisted"},Do={__name:"YoutubeOptions",props:["options"],setup(e){return(t,s)=>(a(),S(xe,{title:t.$t("service.provider_options",{provider:"YouTube"}),provider:"youtube"},{default:n(()=>[h("div",null,[h("div",Io,[o(Ve,{modelValue:e.options.title,"onUpdate:modelValue":s[0]||(s[0]=r=>e.options.title=r),type:"text",placeholder:t.$t("service.youtube.title"),id:"youtube_title"},null,8,["modelValue","placeholder"])]),h("div",Po,[o($e,{for:"privacy-status"},{default:n(()=>[L(u(t.$t("service.youtube.privacy_config")),1)]),_:1}),o(qe,{modelValue:e.options.status,"onUpdate:modelValue":s[1]||(s[1]=r=>e.options.status=r),id:"privacy-status"},{default:n(()=>[h("option",So,u(t.$t("service.youtube.public")),1),h("option",Mo,u(t.$t("service.youtube.private")),1),h("option",Uo,u(t.$t("service.youtube.unlisted")),1)]),_:1},8,["modelValue"])])])]),_:1},8,["title"]))}},Oo={class:"w-full"},Fo={class:"w-full mt-xs"},Bo={class:"mt-xs"},qo=["innerHTML"],Ro={class:"flex items-center"},zo={class:"mr-xs"},jo=["value"],Ho={class:"w-auto"},No={for:"board_name"},Wo={__name:"PinterestOptions",props:["options","accounts","activeVersion"],setup(e){const{t}=de(),s=X("workspaceCtx"),r=e,{notify:i}=be(),p=z(()=>r.activeVersion===0?r.accounts:r.accounts.filter(k=>k.id===r.activeVersion)),_=W(!1),f=kt({name:"",account_uuid:null}),c=k=>{f.account_uuid=k.uuid,_.value=!0},$=()=>{_.value=!1},m=()=>{f.clearErrors(),f.post(route("mixpost.provider.pinterest.storeBoard",{workspace:s.id}),{preserveScroll:!0,onSuccess(){i("success",t("service.pinterest.board_created")),$(),f.reset()},onError(){i("error",t("service.pinterest.board_not_added"))}})};return(k,E)=>(a(),y(G,null,[o(xe,{title:l(t)("service.provider_options",{provider:"Pinterest"}),provider:"pinterest"},{default:n(()=>[h("div",Oo,[o(Ve,{modelValue:e.options.title,"onUpdate:modelValue":E[0]||(E[0]=A=>e.options.title=A),type:"text",placeholder:l(t)("general.title"),id:"p_title"},null,8,["modelValue","placeholder"])]),h("div",Fo,[o(Ve,{modelValue:e.options.link,"onUpdate:modelValue":E[1]||(E[1]=A=>e.options.link=A),type:"text",placeholder:l(t)("general.link"),id:"p_link"},null,8,["modelValue","placeholder"])]),h("div",Bo,[(a(!0),y(G,null,oe(p.value,A=>(a(),y("div",{key:A.id,class:"w-full mt-xs"},[o($e,null,{default:n(()=>[h("span",{innerHTML:l(t)("service.pinterest.select_board_for",{account:A.name})},null,8,qo),o(Qe,{danger:!0},{default:n(()=>E[4]||(E[4]=[L("*")])),_:1})]),_:2},1024),h("div",Ro,[h("div",zo,[o(qe,{modelValue:e.options.boards[`account-${A.id}`],"onUpdate:modelValue":M=>e.options.boards[`account-${A.id}`]=M},{default:n(()=>[(a(!0),y(G,null,oe(A.relationships.boards,M=>(a(),y("option",{value:M.id},u(M.name),9,jo))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),h("div",Ho,[o(le,{onClick:M=>c(A)},{default:n(()=>[L(u(l(t)("service.pinterest.create_board")),1)]),_:2},1032,["onClick"])])])]))),128))])]),_:1},8,["title"]),o(Oe,{show:_.value,closeable:!0,"max-width":"sm",onClose:E[3]||(E[3]=A=>_.value=!1)},{header:n(()=>[L(u(l(t)("service.pinterest.create_board")),1)]),body:n(()=>[_.value?(a(),S(at,{key:0},{title:n(()=>[h("label",No,[L(u(l(t)("service.pinterest.board_name"))+" ",1),o(Qe,{danger:!0},{default:n(()=>E[5]||(E[5]=[L("*")])),_:1})])]),footer:n(()=>[o(ms,{message:l(f).errors.name},null,8,["message"])]),default:n(()=>[o(Ve,{type:"text",modelValue:l(f).name,"onUpdate:modelValue":E[2]||(E[2]=A=>l(f).name=A),error:l(f).errors.name,id:"board_name",required:"",autofocus:""},null,8,["modelValue","error"])]),_:1})):I("",!0)]),footer:n(()=>[o(pe,{onClick:m,isLoading:l(f).processing,disabled:l(f).processing,class:"mr-xs"},{default:n(()=>[L(u(l(t)("service.pinterest.create_board")),1)]),_:1},8,["isLoading","disabled"]),o(le,{onClick:$},{default:n(()=>[L(u(l(t)("general.close")),1)]),_:1})]),_:1},8,["show"])],64))}},Yo={class:"w-full"},Zo={value:"PUBLIC"},Go={value:"CONNECTIONS"},Ko={__name:"LinkedinOptions",props:["options"],setup(e){return(t,s)=>(a(),S(xe,{title:t.$t("service.provider_options",{provider:"LinkedIn"}),provider:"linkedin"},{default:n(()=>[h("div",Yo,[o($e,null,{default:n(()=>[L(u(t.$t("service.linkedin.visibility")),1)]),_:1}),o(qe,{modelValue:e.options.visibility,"onUpdate:modelValue":s[0]||(s[0]=r=>e.options.visibility=r)},{default:n(()=>[h("option",Zo,u(t.$t("service.linkedin.public")),1),h("option",Go,u(t.$t("service.linkedin.connections")),1)]),_:1},8,["modelValue"])])]),_:1},8,["title"]))}},Re=()=>{const e=X("postCtx"),t=z(()=>e.errors),s=z(()=>K.isEmpty(t.value)),r=({group:c,key:$,message:m})=>{e.errors[c]||(e.errors[c]={}),e.errors[c][$]=m},i=({group:c,key:$,message:m,accountId:k,accountName:E,providerName:A})=>{let M=A?`${A}`:"";M+=E?` (${E})`:"",M+=m?` → ${m}`:"",r({group:c,key:`${k}_${$}`,message:M})},p=({group:c,key:$=null})=>{if(!(!e.errors||!e.errors[c])){if(!$){delete e.errors[c];return}e.errors[c][$]&&delete e.errors[c][$],K.isEmpty(e.errors[c])&&delete e.errors[c]}};return{errors:t,validationPassed:s,addError:r,addAccountError:i,removeError:p,removeAccountError:({group:c,key:$,accountId:m})=>{p({group:c,key:`${m}_${$}`})},clearErrors:()=>{e.errors={}}}},Qo={},Jo={class:"relative rounded-lg border border-gray-200 p-xs mb-lg last:mb-0"},Xo={class:"font-semibold absolute top-0 -mt-md bg-white p-0.5"},en={class:"mt-xs p-xs"};function tn(e,t){return a(),y("div",Jo,[h("div",Xo,[he(e.$slots,"title")]),h("div",en,[he(e.$slots,"default")])])}const sn=ue(Qo,[["render",tn]]),on={class:"w-full"},nn=["value","disabled"],rn={class:"mt-md"},an=["for"],ln={class:"text-sm"},cn=["for"],dn={class:"text-sm"},un=["for"],mn={class:"text-sm"},pn={key:0,class:"flex items-center mt-xs text-sm text-orange-600 border border-orange-600 rounded-md p-xs"},vn={class:"mt-md italic"},fn={class:"mt-md"},_n=["innerHTML"],hn=["innerHTML"],gn=["innerHTML"],Ze="https://www.tiktok.com/legal/page/global/music-usage-confirmation/en",ht="https://www.tiktok.com/legal/page/global/bc-policy/en",yn={__name:"TikTokOptions",props:["options","accounts","activeVersion"],setup(e){const{t}=de(),s=e,{addAccountError:r,removeAccountError:i,removeError:p}=Re(),_=z(()=>s.activeVersion===0?s.accounts:s.accounts.filter(v=>v.id===s.activeVersion)),f=()=>{_.value.forEach(v=>{K.get(s.options.privacy_level,`account-${v.id}`)||(s.options.allow_comments[`account-${v.id}`]=!1,s.options.allow_duet[`account-${v.id}`]=!1,s.options.allow_stitch[`account-${v.id}`]=!1,s.options.content_disclosure[`account-${v.id}`]=!1,s.options.brand_organic_toggle[`account-${v.id}`]=!1,s.options.brand_content_toggle[`account-${v.id}`]=!1)})},c=v=>Array.isArray(v.data.privacy_levels)?K.clone(v.data.privacy_levels).map(g=>{const w={PUBLIC_TO_EVERYONE:t("service.tiktok.everyone"),MUTUAL_FOLLOW_FRIENDS:t("service.tiktok.friends"),SELF_ONLY:t("service.tiktok.only_you"),FOLLOWER_OF_CREATOR:t("service.tiktok.followers")};return{key:g,name:w.hasOwnProperty(g)?w[g]:g}}):[],$=v=>s.options.privacy_level[`account-${v.id}`],m=v=>s.options.content_disclosure[`account-${v.id}`],k=v=>s.options.brand_organic_toggle[`account-${v.id}`],E=v=>s.options.brand_content_toggle[`account-${v.id}`],A=v=>{const O=s.options.brand_organic_toggle[`account-${v.id}`],g=s.options.brand_content_toggle[`account-${v.id}`];return O&&g?t("service.tiktok.partner_video_alert"):O&&!g?t("service.tiktok.promo_video_alert"):g?t("service.tiktok.partner_video_alert"):null},M=v=>s.options.content_disclosure[`account-${v.id}`]&&s.options.brand_content_toggle[`account-${v.id}`],C=v=>{const O=$(v);return!O||O==="SELF_ONLY"},T=v=>{d(v),C(v)&&(s.options.brand_content_toggle[`account-${v.id}`]=!1)},V=v=>{if(m(v)&&!k(v)&&!E(v)){r({group:"tik_tok",key:"content_disclosure",message:t("service.tiktok.content_disclosure_required"),accountId:v.id,accountName:v.name,providerName:v.provider_name});return}i({group:"tik_tok",key:"content_disclosure",accountId:v.id})},d=v=>{if(!$(v)){r({group:"tik_tok",key:"privacy_level",message:t("service.tiktok.privacy_level_required"),accountId:v.id,accountName:v.name,providerName:v.provider_name});return}i({group:"tik_tok",key:"privacy_level",accountId:v.id})},b=()=>{p({group:"tik_tok"})},x=()=>{_.value.forEach(v=>{d(v),V(v)})};return ne(()=>s.accounts,()=>{f(),b(),x()}),ae(()=>{x()}),Ee(()=>{b()}),(v,O)=>(a(),S(xe,{title:l(t)("service.provider_options",{provider:"TikTok"}),provider:"tiktok"},{default:n(()=>[(a(!0),y(G,null,oe(_.value,g=>(a(),S(sn,{key:g.id},{title:n(()=>[L(u(g.name),1)]),default:n(()=>[h("div",on,[o($e,{for:`privacy_level-${g.id}`},{default:n(()=>[L(u(l(t)("service.tiktok.who_watch_video")),1)]),_:2},1032,["for"]),o(qe,{modelValue:e.options.privacy_level[`account-${g.id}`],"onUpdate:modelValue":w=>e.options.privacy_level[`account-${g.id}`]=w,onChange:w=>T(g),id:`privacy_level-${g.id}`},{default:n(()=>[(a(!0),y(G,null,oe(c(g),w=>(a(),y("option",{value:w.key,key:w.key,disabled:w.key==="SELF_ONLY"&&M(g)},[L(u(w.name)+" ",1),w.key==="SELF_ONLY"&&M(g)?(a(),y(G,{key:0},[L(" ("+u(l(t)("service.tiktok.branded_no_private"))+") ",1)],64)):I("",!0)],8,nn))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","id"])]),o(at,{class:"mt-md"},{title:n(()=>[L(u(l(t)("service.tiktok.allow_users")),1)]),default:n(()=>[o(se,{gap:"gap-md",class:"md:items-center"},{default:n(()=>[o($e,{for:`allow_comments-${g.id}`,class:"!mb-0"},{default:n(()=>[o(Te,{checked:e.options.allow_comments[`account-${g.id}`],"onUpdate:checked":w=>e.options.allow_comments[`account-${g.id}`]=w,disabled:g.data.comment_disabled,id:`allow_comments-${g.id}`},null,8,["checked","onUpdate:checked","disabled","id"]),L(" "+u(l(t)("service.tiktok.comment")),1)]),_:2},1032,["for"]),o($e,{for:`allow_duet-${g.id}`,class:"!mb-0"},{default:n(()=>[o(Te,{checked:e.options.allow_duet[`account-${g.id}`],"onUpdate:checked":w=>e.options.allow_duet[`account-${g.id}`]=w,disabled:g.data.duet_disabled,id:`allow_duet-${g.id}`},null,8,["checked","onUpdate:checked","disabled","id"]),L(" "+u(l(t)("service.tiktok.duet")),1)]),_:2},1032,["for"]),o($e,{for:`allow_stitch-${g.id}`,class:"!mb-0"},{default:n(()=>[o(Te,{checked:e.options.allow_stitch[`account-${g.id}`],"onUpdate:checked":w=>e.options.allow_stitch[`account-${g.id}`]=w,disabled:g.data.stitch_disabled,id:`allow_stitch-${g.id}`},null,8,["checked","onUpdate:checked","disabled","id"]),L(" "+u(l(t)("service.tiktok.stitch")),1)]),_:2},1032,["for"])]),_:2},1024)]),_:2},1024),h("div",rn,[o(Ne,{flexColMobile:!1,forceFullWidth:!0,forceFlexStart:!0,removeFullWidthFromDefaultSlot:!0,class:"mt-md"},{title:n(()=>[h("label",{for:`content_disclosure-${g.id}`},u(l(t)("service.tiktok.disclose")),9,an)]),description:n(()=>[h("span",ln,u(l(t)("service.tiktok.disclose_desc")),1)]),default:n(()=>[o(Ms,{id:`content_disclosure-${g.id}`,modelValue:e.options.content_disclosure[`account-${g.id}`],"onUpdate:modelValue":[w=>e.options.content_disclosure[`account-${g.id}`]=w,w=>V(g)]},null,8,["id","modelValue","onUpdate:modelValue"])]),_:2},1024),e.options.content_disclosure[`account-${g.id}`]?(a(),y(G,{key:0},[A(g)?(a(),S(Me,{key:0,closeable:!1,class:"mt-md"},{default:n(()=>[h("span",null,u(A(g)),1)]),_:2},1024)):I("",!0),o(Ne,{flexColMobile:!1,forceFullWidth:!0,forceFlexStart:!0,removeFullWidthFromDefaultSlot:!0,class:"mt-md"},{title:n(()=>[h("label",{for:`brand_organic_toggle-${g.id}`},u(l(t)("service.tiktok.your_brand")),9,cn)]),description:n(()=>[h("span",dn,u(l(t)("service.tiktok.your_brand_desc")),1)]),default:n(()=>[o(Te,{checked:e.options.brand_organic_toggle[`account-${g.id}`],"onUpdate:checked":w=>e.options.brand_organic_toggle[`account-${g.id}`]=w,id:`brand_organic_toggle-${g.id}`,"onUpdate:modelValue":w=>V(g)},null,8,["checked","onUpdate:checked","id","onUpdate:modelValue"])]),_:2},1024),o(Ne,{flexColMobile:!1,forceFullWidth:!0,forceFlexStart:!0,removeFullWidthFromDefaultSlot:!0,class:"mt-md"},{title:n(()=>[h("label",{for:`brand_content_toggle-${g.id}`},u(l(t)("service.tiktok.branded_content")),9,un)]),description:n(()=>[h("span",mn,u(l(t)("service.tiktok.branded_content_desc")),1),C(g)?(a(),y("span",pn,[o(Lt,{class:"mr-xs"}),L(" "+u(l(t)("service.tiktok.visibility_branded_content")),1)])):I("",!0)]),default:n(()=>[o(Te,{checked:e.options.brand_content_toggle[`account-${g.id}`],"onUpdate:checked":w=>e.options.brand_content_toggle[`account-${g.id}`]=w,disabled:C(g),id:`brand_content_toggle-${g.id}`,"onUpdate:modelValue":w=>V(g)},null,8,["checked","onUpdate:checked","disabled","id","onUpdate:modelValue"])]),_:2},1024)],64)):I("",!0)]),h("p",vn,"* "+u(l(t)("post.video_processing_notice")),1),h("div",fn,[e.options.content_disclosure[`account-${g.id}`]&&e.options.brand_organic_toggle[`account-${g.id}`]&&e.options.brand_content_toggle[`account-${g.id}`]?(a(),y("div",{key:0,innerHTML:l(t)("service.tiktok.accept_terms",{href_brand:ht,href_music:Ze})},null,8,_n)):e.options.content_disclosure[`account-${g.id}`]&&e.options.brand_content_toggle[`account-${g.id}`]?(a(),y("div",{key:1,innerHTML:l(t)("service.tiktok.accept_terms",{href_brand:ht,href_music:Ze})},null,8,hn)):(a(),y("div",{key:2,innerHTML:l(t)("service.tiktok.your_brand_accept_terms",{href:Ze})},null,8,gn))])]),_:2},1024))),128))]),_:1},8,["title"]))}},kn={__name:"MastodonOptions",props:["options"],setup(e){return(t,s)=>(a(),S(xe,{title:t.$t("service.provider_options",{provider:"Mastodon"}),provider:"mastodon"},{default:n(()=>[h("label",null,[o(Te,{checked:e.options.sensitive,"onUpdate:checked":s[0]||(s[0]=r=>e.options.sensitive=r)},null,8,["checked"]),L(" "+u(t.$t("service.mastodon.mark_media")),1)])]),_:1},8,["title"]))}},$n={class:"flex items-center space-x-sm"},wn={__name:"FacebookPageOptions",props:["options","activeVersion","versions"],setup(e){return(t,s)=>(a(),S(xe,{title:t.$t("service.facebook.page_options"),provider:"facebook_page"},{default:n(()=>[h("div",null,[h("div",$n,[h("label",null,[o(Ae,{checked:e.options.type,"onUpdate:checked":s[0]||(s[0]=r=>e.options.type=r),value:"post"},null,8,["checked"]),L(" "+u(t.$t("service.meta.post")),1)]),h("label",null,[o(Ae,{checked:e.options.type,"onUpdate:checked":s[1]||(s[1]=r=>e.options.type=r),value:"reel"},null,8,["checked"]),L(" "+u(t.$t("service.meta.reel")),1)]),h("label",null,[o(Ae,{checked:e.options.type,"onUpdate:checked":s[2]||(s[2]=r=>e.options.type=r),value:"story"},null,8,["checked"]),L(" "+u(t.$t("service.meta.story")),1)])])])]),_:1},8,["title"]))}},bn={key:0},xn={key:0,class:"pb-md"},Cn={key:1,class:"pb-md"},Tn={key:2,class:"pb-md"},Vn={key:3,class:"pb-md"},An={key:4,class:"pb-md"},Ln={key:5,class:"pb-md"},En={key:6,class:"pb-md"},In={__name:"PostVersionOptions",props:{selectedAccounts:{required:!0,type:Array},versions:{required:!0,type:Array},activeVersion:{required:!0,type:Number}},setup(e){const t=e,{getAccountVersion:s}=ge(),r=z(()=>s(t.versions,t.activeVersion).options),i=z(()=>t.selectedAccounts.filter(V=>t.versions.some(d=>d.account_id===V.id))),p=V=>i.value.some(d=>t.activeVersion===d.id&&d.provider===V),_=V=>t.selectedAccounts.some(d=>d.provider===V),f=V=>i.value.some(d=>d.provider===V),c=z(()=>t.activeVersion===0&&_("mastodon")?!f("mastodon"):p("mastodon")),$=z(()=>t.activeVersion===0&&_("facebook_page")?!f("facebook_page"):p("facebook_page")),m=z(()=>t.activeVersion===0&&_("instagram")?!f("instagram"):p("instagram")),k=z(()=>t.activeVersion===0&&_("youtube")?!f("youtube"):p("youtube")),E=z(()=>t.activeVersion===0&&_("pinterest")?!f("pinterest"):p("pinterest")),A=z(()=>E.value?t.selectedAccounts.filter(V=>V.provider==="pinterest"):[]),M=z(()=>t.activeVersion===0&&_("linkedin")?!f("linkedin"):p("linkedin")),C=z(()=>et().props.service_configs.tiktok.share_type==="inbox"?!1:t.activeVersion===0&&_("tiktok")?!f("tiktok"):p("tiktok")),T=z(()=>C.value?t.selectedAccounts.filter(V=>V.provider==="tiktok"):[]);return(V,d)=>e.selectedAccounts.length?(a(),y("div",bn,[c.value?(a(),y("div",xn,[o(kn,{options:r.value.mastodon},null,8,["options"])])):I("",!0),$.value?(a(),y("div",Cn,[o(wn,{options:r.value.facebook_page,activeVersion:e.activeVersion,versions:e.versions},null,8,["options","activeVersion","versions"])])):I("",!0),m.value?(a(),y("div",Tn,[o(Eo,{options:r.value.instagram,activeVersion:e.activeVersion,versions:e.versions},null,8,["options","activeVersion","versions"])])):I("",!0),k.value?(a(),y("div",Vn,[o(Do,{options:r.value.youtube},null,8,["options"])])):I("",!0),E.value?(a(),y("div",An,[o(Wo,{options:r.value.pinterest,accounts:A.value,activeVersion:e.activeVersion},null,8,["options","accounts","activeVersion"])])):I("",!0),M.value?(a(),y("div",Ln,[o(Ko,{options:r.value.linkedin},null,8,["options"])])):I("",!0),C.value?(a(),y("div",En,[o(yn,{options:r.value.tiktok,accounts:T.value,activeVersion:e.activeVersion},null,8,["options","accounts","activeVersion"])])):I("",!0)])):I("",!0)}},Pn={class:"relative mt-sm"},Sn={class:"flex justify-end"},Mn={__name:"TemplateList",props:{templates:{type:Array,default:[]}},emits:["update","edit","select"],setup(e,{emit:t}){const s=X("workspaceCtx"),r=e,i=t,p=W(!1),_=()=>{me.start(),r.templates.length||(p.value=!0),axios.get(route("mixpost.templates.api.index",{workspace:s.id})).then(c=>{i("update",c.data.data)}).finally(()=>{me.done(),p.value=!1})},f=c=>{axios.delete(route("mixpost.templates.api.delete",{workspace:s.id,template:c.id})),i("update",r.templates.filter($=>$.id!==c.id))};return ae(()=>{_()}),(c,$)=>(a(),y("div",Pn,[!e.templates.length&&p.value?(a(),S(Fe,{key:0})):I("",!0),!e.templates.length&&!p.value?(a(),S(Ft,{key:1},{default:n(()=>[L(u(c.$t("template.do_not_have_templates")),1)]),_:1})):(a(),S(Os,{key:2,items:e.templates,columns:3},{default:n(({item:m})=>[o(lt,{class:"group"},{default:n(()=>[o(ct,{withClassesForLast:!1},{default:n(()=>[o(Ds,{template:m},{action:n(()=>[h("div",Sn,[o(pe,{onClick:k=>c.$emit("select",m),size:"sm",class:"group-visible mr-xs"},{default:n(()=>[L(u(c.$t("general.use")),1)]),_:2},1032,["onClick"]),o(De,{placement:"bottom-end"},{trigger:n(()=>[o(ke,{class:"mt-1"},{default:n(()=>[o(Us)]),_:1})]),content:n(()=>[o(we,{onClick:k=>c.$emit("edit",m),as:"button"},{default:n(()=>[o(Et,{class:"!w-5 !h-5 mr-1"}),L(" "+u(c.$t("general.edit")),1)]),_:2},1032,["onClick"]),o(we,{onClick:k=>f(m),as:"button"},{default:n(()=>[o(Ot,{class:"!w-5 !h-5 mr-1 text-red-500"}),L(" "+u(c.$t("general.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1032,["template"])]),_:2},1024)]),_:2},1024)]),_:1},8,["items"]))]))}},Un={for:"template_name"},Dn={__name:"TemplateForm",props:{template:{type:[Object,null],default:null},content:{type:Array,required:!0}},emits:["store","update"],setup(e,{emit:t}){const s=X("workspaceCtx"),r=e,i=t,p=W(!1),_=W(r.template?r.template:{name:""}),f=m=>{me.start(),p.value=!0,axios.post(route("mixpost.templates.api.store",{workspace:s.id}),m).then(k=>{i("store",k.data)}).finally(()=>{me.done(),p.value=!1})},c=m=>{me.start(),p.value=!0,axios.put(route("mixpost.templates.api.update",{workspace:s.id,template:r.template.id}),m).then(()=>{i("update",_.value),me.done(),p.value=!1})},$=()=>{const m={..._.value,content:r.content.map(k=>({body:k.body,media:k.media.map(E=>E.id)}))};if(r.template){c(m);return}f(m)};return(m,k)=>(a(),y("form",{onSubmit:wt($,["prevent"])},[o(at,null,{title:n(()=>[h("label",Un,[L(u(m.$t("template.template_name"))+" ",1),o(Qe,{danger:!0},{default:n(()=>k[1]||(k[1]=[L("*")])),_:1})])]),default:n(()=>[o(Ve,{type:"text",modelValue:_.value.name,"onUpdate:modelValue":k[0]||(k[0]=E=>_.value.name=E),id:"template_name",required:""},null,8,["modelValue"])]),_:1}),o(Me,{variant:"info",closeable:!1,class:"mt-xs"},{default:n(()=>[L(u(m.$t("template.save_content_current_version")),1)]),_:1}),o(pe,{type:"submit",isLoading:p.value,class:"mt-sm"},{default:n(()=>[L(u(m.$t("template.save_template")),1)]),_:1},8,["isLoading"])],32))}},On={class:"flex items-center"},Fn={key:2,class:"w-full max-w-xl"},Bn={__name:"TemplateManager",props:{postContent:{type:Array,default:[]}},emits:["insert"],setup(e,{emit:t}){const s=W(!1),r=W(!1),i=W(null),p=W(null),_=W([]),f=()=>{s.value=!0,$()},c=()=>{s.value=!1,i.value=null},$=()=>{i.value="list"},m=(E=null)=>{p.value=E,i.value="form"},k=E=>{_.value.unshift(E)};return(E,A)=>{const M=Le("tooltip");return a(),y("div",null,[_e((a(),S(Ct,{onClick:f},{default:n(()=>[o(vt)]),_:1})),[[M,E.$t("template.open_template_manager")]]),o(Oe,{show:s.value,"max-width":"5xl",closeable:!0,"scrollable-body":!0,onClose:c},{header:n(()=>[h("div",On,[o(vt,{class:"mr-xs"}),L(" "+u(E.$t("template.template_manager")),1)])]),body:n(()=>[r.value?(a(),S(Fe,{key:0,opacity:50})):I("",!0),i.value==="list"?(a(),S(Mn,{key:1,templates:_.value,onUpdate:A[0]||(A[0]=C=>_.value=C),onEdit:A[1]||(A[1]=C=>m(C)),onSelect:A[2]||(A[2]=C=>{E.$emit("insert",C),c()})},null,8,["templates"])):I("",!0),i.value==="form"?(a(),y("div",Fn,[o(Dn,{template:p.value,content:e.postContent,onStore:A[3]||(A[3]=C=>{k(C),$()}),onUpdate:$},null,8,["template","content"])])):I("",!0)]),footer:n(()=>[i.value==="list"?(a(),S(pe,{key:0,onClick:A[4]||(A[4]=()=>m(null)),class:"mr-xs"},{default:n(()=>[L(u(E.$t("template.save_as_template")),1)]),_:1})):I("",!0),i.value==="form"?(a(),S(le,{key:1,onClick:$,class:"mr-xs"},{default:n(()=>[L(u(E.$t("general.go_back")),1)]),_:1})):I("",!0),o(le,{onClick:c},{default:n(()=>[L(u(E.$t("general.done")),1)]),_:1})]),_:1},8,["show"])])}}},qn={},Rn={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"};function zn(e,t){return a(),y("svg",Rn,t[0]||(t[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"},null,-1)]))}const jn=ue(qn,[["render",zn]]);function Hn(e){const t=["photos","videos","gifs","allow_mixing"],s=["photos","videos","gifs"],{accountHasVersion:r}=ge(),{getCharLimitForType:i}=ut(),p=z(()=>e.selectedAccounts.filter(d=>!r(e.versions,d.id))),_=d=>e.selectedAccounts.some(b=>b.id===d),f=()=>K.filter(e.versions,d=>d.account_id===0||_(d.account_id)),c=(d,b,x,v)=>{const O=v.post_configs.media_limit[d][b];return O.hasOwnProperty(x)?O[x]:O.default},$=d=>{const b={},x=e.versions.find(O=>O.account_id===d),v=d===0?p.value:e.selectedAccounts.filter(O=>O.id===d);return t.forEach(O=>{const g=v.map(w=>{var j;const P=((j=x==null?void 0:x.options[w.provider])==null?void 0:j.type)||"default",B=c("max",O,P,w);return{account_id:w.id,provider:w.provider_name,limit:B}});b[O]=g.length?K.minBy(g,"limit"):null}),K.isEmpty(b)?null:b},m=d=>{const b={},x=e.versions.find(O=>O.account_id===d),v=d===0?p.value:e.selectedAccounts.filter(O=>O.id===d);return s.forEach(O=>{const g=v.map(w=>{var j;const P=((j=x==null?void 0:x.options[w.provider])==null?void 0:j.type)||"default",B=c("min",O,P,w);return{account_id:w.id,provider:w.provider_name,limit:B,priority:i("min",P,w)===0?1:0}});g.length?b[O]=g.reduce((w,P)=>P.priority>w.priority||P.priority===w.priority&&P.limit>w.limit?P:w,g[0]):b[O]=null}),K.isEmpty(b)?null:b},k=d=>{if(!d){if(!p.value.length)return null;const v=$(d);return t.reduce((O,g)=>(O[g]=v[g],O),{})}if(!e.selectedAccounts.find(v=>v.id===d))return null;const x=$(d);return t.reduce((v,O)=>(v[O]=x[O],v),{})},E=d=>{const b=m(d);return s.reduce((x,v)=>(x[v]=b[v],x),{})},A=d=>Object.values(d).filter(x=>x!==0).length>1,M=d=>{const b={photos:K.filter(d,{type:"image"}).length,videos:K.filter(d,{type:"video"}).length,gifs:K.filter(d,{type:"gif"}).length};return{...b,mixing:A(b)}},C=z(()=>{var d,b;return(b=(d=f().find(x=>x.account_id===e.activeVersion))==null?void 0:d.content[e.activeContent])==null?void 0:b.media}),T=z(()=>k(e.activeVersion)),V=z(()=>M(C.value));return{mediaTypesAll:t,mediaTypesBasic:s,currentMedia:C,currentMediaMaxLimits:T,currentMediaUsed:V,getMediaMaxLimits:k,getMediaMinLimits:E,getMediaLength:M}}const Nn=e=>{const{accountHasVersion:t}=ge(),s=z(()=>e.selectedAccounts.filter(_=>!t(e.versions,_.id))),r=(_,f)=>{const c=f.post_configs.media_text_requirement_operator;return c.hasOwnProperty(_)?c[_]:c.default},i=_=>{if(!e.selectedAccounts.length)return null;const f=e.versions.find(m=>m.account_id===_),$=(_===0?s.value:e.selectedAccounts.filter(m=>m.id===_)).map(m=>{var A;const k=((A=f==null?void 0:f.options[m.provider])==null?void 0:A.type)||"default",E=r(k,m);return{account_id:m.id,provider:{id:m.provider,name:m.provider_name},operator:E}});return $.length?K.minBy($,"operator"):null};return{getRequirementOperator:_=>i(_)}},Se="media",Ge="char_limit",Wn={__name:"PostContentValidator",props:{selectedAccounts:{type:Array,required:!0},versions:{type:Array,required:!0},activeVersion:{type:Number,required:!0},activeContent:{type:Number,required:!0}},setup(e){const{t}=de(),s=e,{addAccountError:r,removeAccountError:i,removeError:p}=Re(),{getTextFromHtmlString:_}=Be(),f=F=>s.selectedAccounts.find(N=>N.id===F)||null,c=F=>s.selectedAccounts.some(N=>N.id===F),$=()=>K.filter(s.versions,F=>F.account_id===0||c(F.account_id)),m=()=>{p({group:Se}),p({group:Ge})};Nn(s);const{currentCharMaxLimit:k,currentCharMinLimit:E,currentCharUsed:A,currentCharLeft:M,getCharMaxLimit:C,getCharMinLimit:T,getTextLength:V,calculateCharLeft:d}=ut(s),b=({charLimit:F,charLeft:N,contentIndex:Y,isThread:U,accountId:R,accountName:Q,providerName:te})=>{if(N<0){const fe=t("post.rules.max_char",{count:F});r({group:Ge,key:`c_${Y}`,message:U?`${t("post.post")} #${Y+1} - ${fe}`:fe,accountId:R,accountName:Q,providerName:te})}else i({group:Ge,key:`c_${Y}`,accountId:R})},{mediaTypesBasic:x,currentMediaMaxLimits:v,currentMediaUsed:O,getMediaMaxLimits:g,getMediaLength:w}=Hn(s),P=({used:F,limits:N,contentIndex:Y,isThread:U,accountId:R,accountName:Q})=>{x.forEach(te=>{F[te]>N[te].limit?r({group:Se,key:`c_${Y}_${te}`,message:U?`${t("post.post")} #${Y+1} - ${t(`post.rules.max_${te}`,N[te].limit)}`:t(`post.rules.max_${te}`,N[te].limit),accountId:R,accountName:Q,providerName:N[te].provider}):i({group:Se,key:`c_${Y}_${te}`,accountId:R})}),F.mixing&&!N.allow_mixing.limit?r({group:Se,key:`c_${Y}_mixing`,message:U?`${t("post.post")} #${Y+1} - ${t("post.rules.no_mixed_media")}`:t("post.rules.no_mixed_media"),accountId:R,accountName:Q,providerName:N.allow_mixing.provider}):i({group:Se,key:`c_${Y}_mixing`,accountId:R})};ne([M,k,v,O],K.debounce(()=>{var Y;const F=f(s.activeVersion),N=$().some(U=>U.account_id===s.activeVersion&&U.content.length>1);b({charLimit:k.value.limit,charLeft:M.value,contentIndex:s.activeContent,isThread:N,accountId:s.activeVersion,accountName:(F==null?void 0:F.name)||"",providerName:(Y=k.value)==null?void 0:Y.provider.name}),v.value&&P({used:O.value,limits:v.value,contentIndex:s.activeContent,isThread:N,accountId:s.activeVersion,accountName:(F==null?void 0:F.name)||""})},100));const B=()=>{$().forEach(F=>{var Q;const N=(Q=f(F.account_id))==null?void 0:Q.name,Y=F.content.length>1,U=C(F.account_id),R=g(F.account_id);F.content.forEach((te,fe)=>{const ze=_(te.body),je=w(te.media);U!=null&&U.limit&&b({charLimit:U.limit,charLeft:d(U.limit,V(U==null?void 0:U.provider.id,ze)),contentIndex:fe,isThread:Y,accountId:F.account_id,accountName:N||"",providerName:U==null?void 0:U.provider.name}),R&&P({used:je,limits:R,contentIndex:fe,isThread:Y,accountId:F.account_id,accountName:N||""})})})},j=()=>{m(),B()};return ne(()=>s.activeVersion,j),ne(()=>s.versions.length,j),ne(()=>s.selectedAccounts,j),ae(()=>{ve.on("postVersionContentDeleted",()=>{j()}),j()}),Ee(()=>{ve.off("postVersionContentDeleted")}),(F,N)=>null}},Yn={class:"flex flex-wrap items-center gap-sm mb-lg"},Zn=["onClick","disabled"],Gn={key:0,class:"absolute top-0 right-0 -mr-sm mt-md"},Kn={key:0,class:"top-0 left-0 absolute w-full h-full z-10"},Qn=["onClick"],Jn={__name:"PostForm",props:{form:{required:!0,type:Object},accounts:{required:!0,type:Array}},setup(e){const t=bt(()=>St(()=>import("./AIAssist-VH7FGqEv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76]))),{t:s}=de(),r=X("confirmation"),i=e,{editAllowed:p}=Ue(),{accountHasVersion:_}=ge(),f=D=>{if(!p.value)return;if(i.form.accounts.includes(D)){i.form.accounts=i.form.accounts.filter(ee=>ee!==D);return}const q=K.clone(i.form.accounts);q.push(D),i.form.accounts=q},c=z(()=>i.accounts.filter(function(D){return m(D)})),$=z(()=>c.value.filter(D=>!D.post_configs.simultaneous_posting).map(D=>D.provider)),m=D=>i.form.accounts.includes(D.id),k=D=>!m(D)&&$.value.includes(D.provider),E=(D,q)=>D.find(ee=>ee.id===q),{versionObject:A,getOriginalVersion:M,getAccountVersion:C,getIndexAccountVersion:T,versionContentObject:V}=ge(),{setupURLMeta:d,setupURLMetaForAllVersions:b}=Ts(),x=W(0),v=W(0),O=()=>{x.value=0},g=z(()=>C(i.form.versions,x.value).content),w=(D,q,ee)=>{const H=T(i.form.versions,x.value);i.form.versions[H].content[D][q]=ee,P(H,D)},P=K.debounce((D,q)=>{const ee=i.form.versions[D].content[q].url;let H="";i.form.versions[D].content[q].media.length||(H=ps(i.form.versions[D].content[q].body)),i.form.versions[D].content[q].url=H,ee!==H&&d(ee,H)},300),B=D=>{const q=E(i.accounts,D);let ee=A(D);const H=M(i.form.versions);ee.content=(()=>{switch(q.content_type){case"comments":return K.cloneDeep(H.content).slice(0,2);case"thread":return K.cloneDeep(H.content);default:return K.cloneDeep(H.content).slice(0,1)}})(),ee.options=K.cloneDeep(H.options),i.form.versions.push(ee),x.value=D},j=D=>{if(!D)return;const q=T(i.form.versions,D);q<0||i.form.versions.splice(q,1)},F=()=>{if(i.form.accounts.includes(x.value)||O(),i.form.accounts.length===1&&x.value===0){const q=i.form.accounts[0];q!==0&&C(i.form.versions,q)&&(x.value=q)}},N=z(()=>g.value.length),Y=()=>x.value===0?c.value.filter(D=>!_(i.form.versions,D.id)):[E(c.value,x.value)],U=z(()=>Y().reduce((D,q)=>(q.content_type==="single"&&D.push(q.provider_name),D),[])),R=z(()=>Y().some(D=>D.content_type==="comments")),Q=z(()=>{var J;const D=((J=C(i.form.versions,x.value))==null?void 0:J.content)||[],q=x.value===0,ee=E(c.value,x.value),H=c.value.some(He=>He.content_type==="comments"),Z=c.value.some(He=>He.content_type==="thread"),ie=ee==null?void 0:ee.content_type;if(q&&H)return{show:D.length<=1,type:"comments",name:s("post.add_first_comment")};if(q&&Z)return{show:!0,type:"thread",name:s("post.add_post")};if(!q){if(ie==="comments")return{show:D.length<=1,type:"comments",name:s("post.add_first_comment")};if(ie==="thread")return{show:!0,type:"thread",name:s("post.add_post")}}return{show:!1,type:"",name:""}}),te=D=>{var Z,ie;const q=((Z=C(i.form.versions,x.value))==null?void 0:Z.content)||[],ee=x.value===0;if(ee&&q.length>1&&c.value.some(J=>J.content_type==="comments")||!ee&&q.length>1&&((ie=E(c.value,x.value))==null?void 0:ie.content_type)==="comments")return;const H=D+1;q.splice(H,0,V()),fe(H)},fe=D=>{g.value.forEach((q,ee)=>{q.opened=ee===D}),ce(()=>{mt({editorId:`postEditor-${D}`})})},ze=D=>{if(g.value.length===1)return;g.value.splice(D,1);const q=D===0?0:D-1;fe(q),ce(()=>{ve.emit("postVersionContentDeleted")})},je=D=>{if(D>0){const q=g.value[D];g.value.splice(D,1),g.value.splice(D-1,0,q)}},Wt=D=>{if(D<g.value.length-1){const q=g.value[D];g.value.splice(D,1),g.value.splice(D+1,0,q)}};ae(()=>{F(),b(i.form.versions)}),ne(()=>i.form.accounts,()=>{F()});const{insertEmoji:Yt,insertContent:Pe,replaceContent:Zt,focusEditor:mt}=Be();return(D,q)=>{const ee=Le("tooltip");return a(),y(G,null,[h("div",Yn,[(a(!0),y(G,null,oe(D.$page.props.accounts,H=>(a(),y("button",{key:H.id,onClick:Z=>f(H.id),disabled:k(H)},[_e(o(Mt,{provider:H.provider,name:H.name,"img-url":H.image,"warning-message":k(H)?l(s)("post.no_simultaneous_post",{provider:H.provider_name}):"",active:m(H)},null,8,["provider","name","img-url","warning-message","active"]),[[ee,H.name]])],8,Zn))),128))]),o(xs,null,{default:n(()=>[e.form.accounts.length>1?(a(),S(_o,{key:0,onAdd:q[0]||(q[0]=H=>{B(H)}),onRemove:q[1]||(q[1]=H=>{j(H),O()}),onSelect:q[2]||(q[2]=H=>{x.value=H}),versions:e.form.versions,"active-version":x.value,accounts:D.$page.props.accounts,"selected-accounts":e.form.accounts,class:"mb-sm"},null,8,["versions","active-version","accounts","selected-accounts"])):I("",!0),o(In,{selectedAccounts:c.value,versions:e.form.versions,activeVersion:x.value},null,8,["selectedAccounts","versions","activeVersion"]),o(se,{col:!0},{default:n(()=>[(a(!0),y(G,null,oe(g.value,(H,Z)=>(a(),y("div",{key:Z,class:re(["relative",{"mt-sm first:mt-0":R.value&&Z===1}])},[R.value&&Z===1?(a(),S(It,{key:0,class:"absolute left-0 -mt-sm ml-sm z-20"},{default:n(()=>[o(Dt,{class:"mr-xs !h-5 !w-5"}),L(" "+u(l(s)("post.first_comment")),1)]),_:1})):I("",!0),H.opened?(a(),y(G,{key:1},[N.value>1&&l(p)?(a(),y("div",Gn,[o(se,{col:"",gap:"gap-0",class:"border border-gray-200 rounded-md bg-white shadow-mix"},{default:n(()=>[o(ke,{onClick:()=>{l(r)().title(l(s)("general.delete")).description(l(s)("page.are_you_sure")).destructive().btnConfirmName(l(s)("general.delete")).onConfirm(ie=>{ze(Z),ie.close()}).show()},destructive:""},{default:n(()=>[o(ot)]),_:2},1032,["onClick"]),o(Pt),Z!==0?(a(),S(ke,{key:0,onClick:ie=>je(Z)},{default:n(()=>[o(jn)]),_:2},1032,["onClick"])):I("",!0),Z<N.value-1?(a(),S(ke,{key:1,onClick:ie=>Wt(Z)},{default:n(()=>[o(Bs)]),_:2},1032,["onClick"])):I("",!0)]),_:2},1024)])):I("",!0),o(os,{id:`postEditor-${Z}`,value:H.body,editable:l(p),onUpdate:ie=>w(Z,"body",ie)},{default:n(ie=>[o(pt,{media:H.media,onUpdated:J=>w(Z,"media",J)},null,8,["media","onUpdated"]),o(se,{responsive:!1,class:"relative justify-between border-t border-gray-200 pt-md mt-md"},{default:n(()=>[l(p)?I("",!0):(a(),y("div",Kn)),o(se,{responsive:!1},{default:n(()=>[o(st,{onSelected:J=>l(Yt)({editorId:`postEditor-${Z}`,emoji:J}),onClose:J=>l(mt)({editorId:`postEditor-${Z}`})},null,8,["onSelected","onClose"]),o(ns,{onInsert:J=>{w(Z,"media",[...H.media,...J.items]),J.crediting&&l(Pe)({editorId:`postEditor-${Z}`,text:J.crediting})}},null,8,["onInsert"]),o(is,{editAllowed:l(p),onInsert:J=>l(Pe)({editorId:`postEditor-${Z}`,text:J})},null,8,["editAllowed","onInsert"]),o(rs,{editAllowed:l(p),onInsert:J=>l(Pe)({editorId:`postEditor-${Z}`,text:J})},null,8,["editAllowed","onInsert"]),o(Bn,{postContent:g.value,onInsert:J=>{w(Z,"media",J.content[0].media),l(Pe)({editorId:`postEditor-${Z}`,text:J.content[0].body})}},null,8,["postContent","onInsert"]),D.$page.props.ai_is_ready_to_use?(a(),S(l(t),{key:0,onInsert:J=>l(Pe)({editorId:`postEditor-${Z}`,text:J}),onReplace:J=>l(Zt)({editorId:`postEditor-${Z}`,text:J}),text:H.body,characterLimit:v.value},null,8,["onInsert","onReplace","text","characterLimit"])):I("",!0)]),_:2},1024),o(se,{responsive:!1},{default:n(()=>[o(Co,{selectedAccounts:c.value,versions:e.form.versions,activeVersion:x.value,activeContent:Z,onUpdateMaxCharLimit:q[3]||(q[3]=J=>v.value=J)},null,8,["selectedAccounts","versions","activeVersion","activeContent"]),Q.value.show?_e((a(),S(Ct,{key:0,onClick:J=>te(Z),class:"flex items-center !text-primary-500"},{default:n(()=>[o(Vt)]),_:2},1032,["onClick"])),[[ee,Q.value.name]]):I("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["id","value","editable","onUpdate"]),c.value.length?(a(),S(Wn,{key:1,selectedAccounts:c.value,activeVersion:x.value,activeContent:Z,versions:e.form.versions},null,8,["selectedAccounts","activeVersion","activeContent","versions"])):I("",!0)],64)):I("",!0),H.opened?I("",!0):(a(),y("div",{key:2,onClick:ie=>fe(Z),role:"button",class:"relative border border-gray-200 rounded-md p-md"},[q[4]||(q[4]=h("div",{class:"top-0 left-0 absolute w-full h-full z-10 bg-white bg-opacity-50 hover:bg-opacity-30 transition ease-in-out duration-200"},null,-1)),o(Fs,{value:H.body},null,8,["value"]),o(pt,{media:H.media,onUpdated:ie=>w(Z,"media",ie)},null,8,["media","onUpdated"])],8,Qn))],2))),128)),g.value.length>1&&Q.value.type==="comments"&&U.value.length?(a(),S(ft,{key:0,variant:"warning",class:"mt-xs"},{default:n(()=>[L(u(l(s)("post.no_first_comment",{providers:U.value.join(", ")})),1)]),_:1})):I("",!0),R.value&&g.value.length>2?(a(),S(ft,{key:1,variant:"warning",class:"mt-xs"},{default:n(()=>[L(u(l(s)("post.only_one_first_comment")),1)]),_:1})):I("",!0)]),_:1})]),_:1})],64)}}},Xn={key:0,class:"pickTime flex flex-col"},ei={class:"flex items-center justify-center mx-auto mt-lg"},ti={class:"mr-xs text-gray-400"},si={class:"text-sm flex items-center justify-center mt-sm"},oi={class:"mr-1"},ni={key:0,class:"mt-xs text-center text-red-500"},ii={__name:"PickTime",props:{show:{type:Boolean,default:!1},date:{type:String,default:""},time:{type:String,default:""},isSubmitActive:{type:Boolean,default:!0}},emits:["close","update"],setup(e,{emit:t}){const s=e,r=t,{t:i}=de(),p=W(),_=W(),f=W(!1),c=W(),{timeZone:$,timeFormat:m,weekStartsOn:k}=it(),E=()=>{if(s.show){if(!s.date&&!s.time){const d=qs.utcToZonedTime(new Date().toISOString(),$),[b,x]=zs(js(d,1),"yyyy-MM-dd H").split(" ");p.value=b,_.value=`${x}:00`;return}p.value=s.date,_.value=s.time}},A=()=>new Promise(d=>{const b=new Date(Bt(`${p.value} ${_.value}`));if(vs(b,$)){f.value=!0,d(!1);return}f.value=!1,d(!0)});ae(()=>{E()}),ne(()=>s.show,()=>{s.show&&E()}),ne([p,_],()=>{A()});const M=async()=>{const d=c.value.querySelector(".flatpickr-hour").value,b=c.value.querySelector(".flatpickr-minute").value;if(m===24&&(_.value=`${d}:${b}`),m===12){const v=c.value.querySelector(".flatpickr-am-pm").innerText;_.value=fs(`${d}:${b} ${v}`)}await A()&&(r("update",{date:p.value,time:_.value}),C())},C=()=>{p.value="",_.value="",r("close")},T={inline:!0,dateFormat:"Y-m-d",minDate:"today",allowInput:!1,monthSelectorType:"static",yearSelectorType:"static",static:!0,locale:{firstDayOfWeek:k,weekdays:{shorthand:[i("calendar.weekdays.sunday.short"),i("calendar.weekdays.monday.short"),i("calendar.weekdays.tuesday.short"),i("calendar.weekdays.wednesday.short"),i("calendar.weekdays.thursday.short"),i("calendar.weekdays.friday.short"),i("calendar.weekdays.saturday.short")],longhand:[i("calendar.weekdays.sunday.full"),i("calendar.weekdays.monday.full"),i("calendar.weekdays.tuesday.full"),i("calendar.weekdays.wednesday.full"),i("calendar.weekdays.thursday.full"),i("calendar.weekdays.friday.full"),i("calendar.weekdays.saturday.full")]},months:{shorthand:[i("calendar.months.january.short"),i("calendar.months.february.short"),i("calendar.months.march.short"),i("calendar.months.april.short"),i("calendar.months.may.short"),i("calendar.months.june.short"),i("calendar.months.july.short"),i("calendar.months.august.short"),i("calendar.months.september.short"),i("calendar.months.october.short"),i("calendar.months.november.short"),i("calendar.months.december.short")],longhand:[i("calendar.months.january.full"),i("calendar.months.february.full"),i("calendar.months.march.full"),i("calendar.months.april.full"),i("calendar.months.may.full"),i("calendar.months.june.full"),i("calendar.months.july.full"),i("calendar.months.august.full"),i("calendar.months.september.full"),i("calendar.months.october.full"),i("calendar.months.november.full"),i("calendar.months.december.full")]}},prevArrow:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg>',nextArrow:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" /></svg>'},V={inline:!0,timeFormat:"H:i",noCalendar:!0,enableTime:!0,time_24hr:m===24};return(d,b)=>{const x=Le("tooltip");return a(),S(Oe,{show:e.show,"max-width":"sm",closeable:!0,onClose:C},{body:n(()=>[e.show?(a(),y("div",Xn,[o(l(_t),{modelValue:p.value,"onUpdate:modelValue":b[0]||(b[0]=v=>p.value=v),config:T},null,8,["modelValue"]),h("div",ei,[h("div",ti,u(l(i)("general.time")),1),h("div",{class:"w-auto",ref_key:"timePicker",ref:c},[o(l(_t),{modelValue:_.value,"onUpdate:modelValue":b[1]||(b[1]=v=>_.value=v),config:V},null,8,["modelValue"])],512)]),h("div",si,[h("div",oi,u(l($)),1),_e((a(),S(l(Gt),{href:d.route("mixpost.profile.index")},{default:n(()=>[o(Rs,{class:"!w-4 !h-4"})]),_:1},8,["href"])),[[x,l(i)("post.post_scheduled_timezone")]])]),f.value?(a(),y("div",ni,u(l(i)("post.past_selected_date")),1)):I("",!0)])):I("",!0)]),footer:n(()=>[o(le,{onClick:C,class:"mr-xs"},{default:n(()=>[L(u(l(i)("general.cancel")),1)]),_:1}),o(pe,{onClick:M,disabled:f.value||!e.isSubmitActive},{default:n(()=>[L(u(l(i)("post.pick_time")),1)]),_:1},8,["disabled"])]),_:1},8,["show"])}}},ri={},ai={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"};function li(e,t){return a(),y("svg",ai,t[0]||(t[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"},null,-1),h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6h.008v.008H6V6z"},null,-1)]))}const ci=ue(ri,[["render",li]]),di={class:"flex items-center rtl:ml-xs"},ui={class:"hidden lg:flex items-center space-x-xs rtl:space-x-reverse mr-xs rtl:mr-0 rtl:ml-xs"},mi={class:"relative"},pi={class:"flex flex-wrap items-center gap-xs"},vi={class:"mt-xs"},fi={class:"flex"},_i={key:2,class:"mt-4 text-stone-800 italic"},hi={__name:"PostTags",props:{items:{type:Array,default:[]}},emits:["update"],setup(e,{emit:t}){const s=X("workspaceCtx"),r=e,i=t,{editAllowed:p}=Ue(),_=W(!1),f=W(""),c=W(!1),$=z(()=>et().props.tags),m=z(()=>$.value.filter(T=>{const V=We(T.name).toLocaleLowerCase().includes(f.value.toLocaleLowerCase());return!r.items.some(d=>d.id===T.id)&&V})),k=()=>{_.value=!0},E=()=>{_.value=!1,f.value=""},A=(T,V=null)=>{(!V||V&&!V.target.closest(".tag-actions"))&&i("update",[...r.items.slice(0),T])},M=T=>{i("update",r.items.filter(V=>V.id!==T.id))},C=()=>{if(c.value||!f.value)return;if(m.value.length===1&&f.value&&We(f.value)===We(m.value[0].name)){f.value="",A(m.value[0]);return}const T=()=>{const V=_s(),d=K.difference(V,$.value.map(b=>b.hex_color));return d.length?d[K.random(0,d.length-1)]:V[K.random(0,V.length-1)]};ye.post(route("mixpost.tags.store",{workspace:s.id}),{name:f.value,hex_color:T()},{onStart(){c.value=!0},onSuccess(){f.value="",A(K.first($.value))},onFinish(){c.value=!1}})};return(T,V)=>(a(),y("div",null,[h("div",di,[h("div",ui,[(a(!0),y(G,null,oe(e.items,d=>(a(),S(Ye,{key:d.id,item:d,removable:l(p),onRemove:b=>M(d)},null,8,["item","removable","onRemove"]))),128))]),l(p)?(a(),S(le,{key:0,onClick:k,hiddenTextOnSmallScreen:!0,size:"md"},{icon:n(()=>[o(ci)]),default:n(()=>[L(" "+u(T.$t("post.labels")),1)]),_:1})):I("",!0)]),o(Oe,{show:_.value,"max-width":"sm",closeable:!0,"scrollable-body":!0,onClose:E},{header:n(()=>[L(u(T.$t("post.labels")),1)]),body:n(()=>[h("div",mi,[c.value?(a(),S(Fe,{key:0,opacity:50})):I("",!0),h("div",pi,[(a(!0),y(G,null,oe(e.items,d=>(a(),y("div",{key:d.id},[o(Ye,{item:d,onRemove:b=>M(d)},null,8,["item","onRemove"])]))),128))]),h("div",vi,[o(Ve,{modelValue:f.value,"onUpdate:modelValue":V[0]||(V[0]=d=>f.value=d),onKeyup:Qt(C,["enter"]),type:"text",autofocus:"",placeholder:T.$t("tag.search_create_post"),class:"w-full"},null,8,["modelValue","placeholder"])]),m.value.length?(a(),S(lt,{key:1,class:"mt-xs"},{default:n(()=>[(a(!0),y(G,null,oe(m.value,d=>(a(),S(ct,{onClick:b=>A(d,b),tabindex:"0",role:"button"},{default:n(()=>[h("div",fi,[o(Ye,{item:d,removable:!1},null,8,["item"])])]),_:2},1032,["onClick"]))),256))]),_:1})):I("",!0),f.value?(a(),y("div",_i,u(T.$t("tag.create_new_label")),1)):I("",!0)])]),footer:n(()=>[o(le,{onClick:E,class:"mr-xs"},{default:n(()=>[L(u(T.$t("general.done")),1)]),_:1})]),_:1},8,["show"])]))}},gi={},yi={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"};function ki(e,t){return a(),y("svg",yi,t[0]||(t[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"},null,-1)]))}const gt=ue(gi,[["render",ki]]),$i=["type"],wi={key:2,class:"absolute left-0 top-0 flex justify-center items-center w-full h-full bg-orange-500 rounded-md"},bi={__name:"WarningButton",props:{type:{type:String,default:"button"},size:{type:String,default:"lg"},isLoading:{type:Boolean,default:!1},hiddenTextOnSmallScreen:{type:Boolean,default:!1}},setup(e){const t=e,{sizeClass:s}=hs(t.size);return(r,i)=>(a(),y("button",{type:e.type,class:re([l(s),"relative inline-flex items-center bg-orange-500 border border-transparent rounded-md font-medium text-xs text-black uppercase tracking-widest rtl:tracking-normal hover:bg-orange-700 active:bg-orange-700 focus:border-orange-700 focus:shadow-outline-orange disabled:bg-orange-200 disabled:text-gray-600 disabled:cursor-not-allowed transition ease-in-out duration-200"])},[r.$slots.icon?(a(),y("span",{key:0,class:re(["inline-flex",{"sm:mr-xs rtl:sm:mr-0 rtl:sm:ml-xs":r.$slots.default,"mr-0 sm:mr-xs rtl:sm:mr-0 rtl:sm:ml-xs":e.hiddenTextOnSmallScreen,"mr-xs rtl:mr-xs rtl:ml-xs":!e.hiddenTextOnSmallScreen&&r.$slots.default}])},[he(r.$slots,"icon")],2)):I("",!0),r.$slots.default?(a(),y("span",{key:1,class:re(["inline-flex items-center",{"hidden sm:inline":e.hiddenTextOnSmallScreen}])},[he(r.$slots,"default")],2)):I("",!0),e.isLoading?(a(),y("span",wi,[o(gs,{class:"animate-spin text-black"})])):I("",!0)],10,$i))}},xi={},Ci={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6"};function Ti(e,t){return a(),y("svg",Ci,t[0]||(t[0]=[h("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 0 1 3.498 1.307 4.491 4.491 0 0 1 1.307 3.497A4.49 4.49 0 0 1 21.75 12a4.49 4.49 0 0 1-1.549 3.397 4.491 4.491 0 0 1-1.307 3.497 4.491 4.491 0 0 1-3.497 1.307A4.49 4.49 0 0 1 12 21.75a4.49 4.49 0 0 1-3.397-1.549 4.49 4.49 0 0 1-3.498-1.306 4.491 4.491 0 0 1-1.307-3.498A4.49 4.49 0 0 1 2.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 0 1 1.307-3.497 4.49 4.49 0 0 1 3.497-1.307Zm7.007 6.387a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"},null,-1)]))}const Vi=ue(xi,[["render",Ti]]),Ai={},Li={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"};function Ei(e,t){return a(),y("svg",Li,t[0]||(t[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"},null,-1)]))}const Ii=ue(Ai,[["render",Ei]]),Pi={class:"w-full flex items-center justify-end bg-stone-500 border-t border-gray-200 z-10"},Si={class:"py-4 flex items-center space-x-xs row-px"},Mi={class:"flex items-center",role:"group"},Ui={key:4,class:"cursor-help"},Di={class:"mt-sm flex flex-wrap items-center gap-xs"},Oi={__name:"PostActions",props:{form:{required:!0,type:Object},hasAvailableTimes:{type:Boolean,default:!1}},emits:["submit"],setup(e,{emit:t}){const{t:s}=de(),r=e,{postId:i,editAllowed:p,needsApproval:_,userCanApprove:f}=Ue(),{validationPassed:c}=Re(),{translatedFormat:$}=Tt(),m=X("workspaceCtx"),k=W(!1),{timeFormat:E,weekStartsOn:A}=it(),M=z(()=>r.form.date&&r.form.time?$(new Date(Bt(r.form.date+" "+r.form.time)),`MMM do, ${E===24?"kk:mm":"h:mmaaa"}`,{weekStartsOn:A}):null),C=()=>{r.form.date="",r.form.time=""},{notify:T}=be(),V=W(!1),d=z(()=>i.value&&r.form.accounts.length&&p.value&&c.value),b=(P=!1)=>{V.value=!0,axios.post(route("mixpost.posts.schedule",{workspace:m.id,post:i.value}),{postNow:P}).then(B=>{const j=`${s("post.post_scheduled")}
${B.data.scheduled_at}
        ${B.data.needs_approval?`<div class="text-sm max-w-xs mt-xs">${s("post.approval_required")}</div>`:""}`;T("success",j,{name:s("post.view_in_calendar"),href:route("mixpost.calendar",{workspace:m.id,date:r.form.date})}),ye.visit(route("mixpost.posts.index",{workspace:m.id}))}).catch(B=>{O(B)}).finally(()=>{V.value=!1})},x=()=>{V.value=!0,axios.post(route("mixpost.posts.addToQueue",{workspace:m.id,post:i.value}),{}).then(P=>{const B=`${s("post.post_scheduled")}
${P.data.scheduled_at}
        ${P.data.needs_approval?`<div class="text-sm max-w-xs mt-xs">${s("post.approval_required")}</div>`:""}`;T("success",B,{name:s("post.view_in_calendar"),href:route("mixpost.calendar",{workspace:m.id,date:P.data.date})}),ye.visit(route("mixpost.posts.index",{workspace:m.id}))}).catch(P=>{O(P)}).finally(()=>{V.value=!1})},v=()=>{V.value=!0,axios.post(route("mixpost.posts.approve",{workspace:m.id,post:i.value})).then(P=>{T("success",`${s("post.post_scheduled")}
${P.data.scheduled_at}`,{name:s("post.view_in_calendar"),href:route("mixpost.calendar",{workspace:m.id,date:r.form.date})}),ye.visit(route("mixpost.posts.index",{workspace:m.id}))}).catch(P=>{O(P)}).finally(()=>{V.value=!1})},O=P=>{if(P.response.status!==422){T("error",P);return}const B=P.response.data.errors,j=B.hasOwnProperty("in_history")||B.hasOwnProperty("publishing");j||T("error",P),j&&ye.visit(route("mixpost.posts.edit",{workspace:m.id,post:i.value}))},g=W(!1),w=z(()=>et().props.accounts.filter(P=>r.form.accounts.includes(P.id)));return(P,B)=>{const j=Le("tooltip");return a(),y("div",Pi,[h("div",Si,[o(hi,{items:e.form.tags,onUpdate:B[0]||(B[0]=F=>e.form.tags=F)},null,8,["items"]),h("div",Mi,[o(le,{size:"md",hiddenTextOnSmallScreen:!0,class:re({"!normal-case border-r-primary-800 ltr:rounded-r-none rtl:rounded-l-none":M.value,"ltr:!rounded-r-lg rtl:!rounded-l-lg":!d.value}),onClick:B[1]||(B[1]=F=>k.value=!0)},{icon:n(()=>[o(ys)]),default:n(()=>[L(" "+u(M.value?M.value:l(s)("post.pick_time")),1)]),_:1},8,["class"]),M.value&&d.value?_e((a(),S(le,{key:0,size:"md",onClick:C,class:"ltr:rounded-l-none ltr:border-l-0 rtl:rounded-r-none rtl:border-r-0 hover:text-red-500 !px-2"},{default:n(()=>[o(ot)]),_:1})),[[j,l(s)("post.clear_time")]]):I("",!0),o(ii,{show:k.value,date:e.form.date,time:e.form.time,isSubmitActive:l(p),onClose:B[2]||(B[2]=F=>k.value=!1),onUpdate:B[3]||(B[3]=F=>{e.form.date=F.date,e.form.time=F.time})},null,8,["show","date","time","isSubmitActive"])]),l(f)&&l(_)?(a(),S(Hs,{key:0,onClick:v,hiddenTextOnSmallScreen:!0,size:"md"},{icon:n(()=>[o(Ii)]),default:n(()=>[L(" "+u(l(s)("post.approve")),1)]),_:1})):I("",!0),l(p)&&!l(f)&&!l(_)&&d.value&&M.value?(a(),S(pe,{key:1,onClick:B[4]||(B[4]=F=>b()),hiddenTextOnSmallScreen:!0,disabled:V.value,isLoading:V.value,size:"md"},{icon:n(()=>[o(gt)]),default:n(()=>[L(" "+u(l(s)("post.schedule")),1)]),_:1},8,["disabled","isLoading"])):I("",!0),l(p)&&l(f)&&!l(_)?(a(),S(pe,{key:2,onClick:B[5]||(B[5]=F=>M.value?b():g.value=!0),hiddenTextOnSmallScreen:!0,disabled:!d.value||V.value,isLoading:V.value,size:"md"},{icon:n(()=>[o(gt)]),default:n(()=>[L(" "+u(M.value?l(s)("post.schedule"):l(s)("post.post_now")),1)]),_:1},8,["disabled","isLoading"])):I("",!0),l(p)&&!l(_)&&e.hasAvailableTimes?(a(),S(bi,{key:3,onClick:x,hiddenTextOnSmallScreen:!0,disabled:!d.value||V.value,size:"md"},{icon:n(()=>[o(ks)]),default:n(()=>[L(" "+u(l(s)("post.add_to_queue")),1)]),_:1},8,["disabled"])):I("",!0),l(p)&&!l(f)?_e((a(),y("div",Ui,[o(Vi,{class:"text-primary-500"})])),[[j,l(s)("post.approval_required")]]):I("",!0)]),o(At,{show:g.value,onClose:B[8]||(B[8]=F=>g.value=!1)},{header:n(()=>[L(u(l(s)("post.confirm_publication")),1)]),body:n(()=>[L(u(l(s)("post.now_confirm_publication"))+" ",1),h("div",Di,[(a(!0),y(G,null,oe(w.value,F=>(a(),S(It,{key:F.id},{default:n(()=>[o(rt,{provider:F.provider,class:"mr-xs"},null,8,["provider"]),L(" "+u(F.name),1)]),_:2},1024))),128))])]),footer:n(()=>[o(le,{onClick:B[6]||(B[6]=F=>g.value=!1),class:"mr-xs"},{default:n(()=>[L(u(l(s)("general.cancel")),1)]),_:1}),o(pe,{disabled:V.value,isLoading:V.value,onClick:B[7]||(B[7]=F=>b(!0))},{default:n(()=>[L(u(l(s)("post.post_now")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])])}}},Fi={key:0,class:"w-full flex items-center row-px py-xs md:py-md flex-row border-b border-gray-200 text-red-500 bg-red-50"},Bi={class:"w-8 h-8 mr-sm flex items-center"},qi={key:0},Ri={class:"list-disc pl-xs"},zi={__name:"PostErrors",setup(e){const{validationPassed:t,errors:s}=Re();return(r,i)=>l(t)?I("",!0):(a(),y("div",Fi,[h("div",Bi,[o(Lt)]),l(K.isEmpty)(l(s))?I("",!0):(a(),y("div",qi,[h("ul",Ri,[(a(!0),y(G,null,oe(l(s),p=>(a(),y(G,null,[(a(!0),y(G,null,oe(p,_=>(a(),y("li",null,u(_),1))),256))],64))),256))])]))]))}},Rt=e=>{const t=W(0),s=()=>{t.value=e.value.scrollTop},r=_=>{e.value.scrollTop=_},i=()=>{r(e.value.scrollHeight-e.value.clientHeight)},p=()=>{const{scrollTop:_,scrollHeight:f,clientHeight:c}=e.value;return _+c>=f-5};return ae(()=>{e.value.addEventListener("scroll",s)}),Ee(()=>{e.value.removeEventListener("scroll",s)}),{scrollPosition:t,setScrollPosition:r,scrollToBottom:i,isNearBottom:p}},ji={},Hi={class:"text-sm text-gray-400"};function Ni(e,t){return a(),y("div",Hi,[he(e.$slots,"default")])}const zt=ue(ji,[["render",Ni]]),Wi={class:"bg-white rounded-md shadow-mix relative"},Yi={__name:"List",props:{items:{type:Array,required:!0},command:{type:Function,required:!0},query:{type:String,required:!0}},setup(e,{expose:t}){const s=e,r=W(null),i=W(0);ne(()=>s.items,()=>{i.value=0});const p=()=>{var E;const k=(E=r.value)==null?void 0:E.$el.querySelectorAll(".list-item")[i.value];k&&k.scrollIntoView({block:"nearest",behavior:"smooth"})},_=()=>{i.value=(i.value+s.items.length-1)%s.items.length,p()},f=()=>{i.value=(i.value+1)%s.items.length,p()},c=()=>{$(i.value)},$=k=>{const E=s.items[k];E&&s.command({id:E.id,label:E.name})};return t({onKeyDown:({event:k})=>k.key==="ArrowUp"?(_(),!0):k.key==="ArrowDown"?(f(),!0):k.key==="Enter"?(c(),!0):!1}),(k,E)=>(a(),y("div",Wi,[e.items.length?(a(),S(lt,{key:0,ref_key:"listGroupElm",ref:r,class:"overflow-y-auto mixpost-scroll-style max-h-72"},{default:n(()=>[(a(!0),y(G,null,oe(e.items,(A,M)=>(a(),S(ct,{key:M,onClick:C=>$(M),active:M===i.value,tabindex:"0",class:"list-item",role:"button"},{default:n(()=>[o(se,{responsive:!1},{default:n(()=>[o(nt,{name:A.name,size:"sm",class:"cursor-default"},null,8,["name"]),h("div",null,u(A.name),1)]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1},512)):(a(),S(Ft,{key:1,withPadding:!0}))]))}},Zi={items:async({editor:e,query:t})=>(await axios.get(route("mixpost.resources.users",{workspace:e.options.editorProps.workspaceId}),{params:{keyword:t}})).data.data.map(r=>({id:r.id,name:r.name})),render:()=>{let e,t;return{onStart:s=>{e=new Ys(Yi,{props:s,editor:s.editor}),s.clientRect&&(t=to("body",{getReferenceClientRect:s.clientRect,appendTo:()=>document.body,content:e.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(s){e.updateProps(s),s.clientRect&&t[0].setProps({getReferenceClientRect:s.clientRect})},onKeyDown(s){var r;return s.event.key==="Escape"?(t[0].hide(),!0):(r=e.ref)==null?void 0:r.onKeyDown(s)},onExit(){t&&t[0]&&t[0].destroy(),e&&e.destroy()}}}},jt={__name:"Editor",props:{modelValue:{required:!0,type:String},editable:{type:Boolean,default:!0}},emits:["update:modelValue","focus","blur","enter"],setup(e,{expose:t,emit:s}){const{t:r}=de(),i=e,p=s,_=X("workspaceCtx"),{defaultExtensions:f,isDocEmpty:c}=Be(),$=Zs({editable:i.editable,content:i.modelValue,extensions:[...f,Gs,Ks,Qs.configure({placeholder:r("post_activity.write_comment")}),Js.configure({openDoubleQuote:!1,closeDoubleQuote:!1,openSingleQuote:!1,closeSingleQuote:!1}),as,Xs.configure({suggestion:Zi})],editorProps:{workspaceId:_==null?void 0:_.id,attributes:{class:"focus:outline-none min-h-[10px] max-h-96 overflow-y-auto"},clipboardTextParser:ls,handleDOMEvents:{keydown:(m,k)=>{!k.shiftKey&&k.which===13&&!m.state.mention$.active&&(p("enter"),k.preventDefault())}}},onUpdate:()=>{const m=$.value.getHTML();if(c(m)){p("update:modelValue","");return}p("update:modelValue",m)},onFocus:()=>{p("focus")},onBlur:()=>{p("blur")}});return tt(()=>{$.value.destroy()}),t({editor:$}),(m,k)=>(a(),S(l(eo),{editor:l($)},null,8,["editor"]))}},Ht={__name:"EditorToolbar",props:{editor:{required:!0,type:Object},text:{required:!1,type:String}},setup(e){const t=bt(()=>St(()=>import("./AIAssist-VH7FGqEv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76])));return(s,r)=>(a(),S(se,null,{default:n(()=>[o(st,{onSelected:r[0]||(r[0]=i=>e.editor.commands.insertContent(i.native))}),s.$page.props.ai_is_ready_to_use?(a(),S(l(t),{key:0,onInsert:r[1]||(r[1]=i=>e.editor.commands.insertContent(i)),onReplace:r[2]||(r[2]=i=>{e.editor.commands.clearContent(),e.editor.commands.insertContent(i)}),text:e.text},null,8,["text"])):I("",!0)]),_:1}))}},Gi={class:"group relative border bg-white border-gray-200 rounded-lg p-md"},Ki={key:0,class:"absolute top-0 right-0 mt-sm mr-sm invisible group-hover:visible"},Qi={class:"mt-xs"},Ji=["onClick"],Xi={class:"mr-1"},er={class:"text-sm"},tr={key:0},sr={key:1},Je={__name:"ItemCommentType",props:{item:{required:!0,type:Object},postId:{required:!0,type:String},isChild:{required:!1,type:Boolean,default:!1}},emits:["delete"],setup(e,{emit:t}){const{t:s}=de(),r=e,i=t,p=X("confirmation"),_=X("routePrefix"),f=X("workspaceCtx"),c=X("postCtx"),$=W(null),{user:m}=$s(),{isWorkspaceAdminRole:k}=ws(),{notify:E}=be(),{VIEW_DEFAULT:A,VIEW_THREAD:M,setThreadParentComment:C,removeItem:T}=Ie({context:c}),V=z(()=>$.value&&$.value.editor),d=W(!1),b=qt({text:r.item.text}),x=()=>{b.text=r.item.text,d.value=!0,V.value&&($.value.editor.options.editable=!0,$.value.editor.commands.focus("end"))},v=()=>{d.value=!1,V.value&&($.value.editor.options.editable=!1)},O=N=>{b.text=N,V.value&&$.value.editor.commands.setContent(r.item.text)},g=()=>{O(r.item.text)},w=N=>{const Y=N.split("-").map(U=>"0x"+U);return String.fromCodePoint(...Y)},P=()=>{b.text&&b.put(route(`${_}.posts.comments.update`,{workspace:f.id,post:r.postId,activity:r.item.id}),{onSuccess:N=>{if(!N){E("error",s("error.something_wrong"));return}N&&(v(),r.item.text=b.text)},onError:N=>E("error",N)})},B=()=>{p().title(s("post_activity.delete_comment")).description(s("post_activity.delete_comment_confirm")).destructive().onConfirm(N=>{N.isLoading(!0),b.delete(route(`${_}.posts.comments.delete`,{workspace:f.id,post:r.postId,activity:r.item.id}),{onSuccess:()=>{N.reset(),r.item.is_child||T({view:A,id:r.item.id}),r.item.is_child&&T({view:M,id:r.item.id}),i("delete")},onError:Y=>{N.reset(),E("error",Y)}})}).show()},j=N=>{axios.post(route(`${_}.posts.comments.react`,{workspace:f.id,post:r.postId,activity:r.item.id}),{reaction:N}).then(function(Y){const U=r.item.reactions.findIndex(R=>R.reaction===Y.data.reaction);Y.data.toggle==="CREATED"&&(U>-1?(r.item.reactions[U].count++,r.item.reactions[U].users.push(m.value)):r.item.reactions.push({reaction:Y.data.reaction,count:1,users:[m.value]})),Y.data.toggle==="DELETED"&&(r.item.reactions[U].count>1?(r.item.reactions[U].count--,r.item.reactions[U].users=r.item.reactions[U].users.filter(R=>R.id!==m.value.id)):r.item.reactions.splice(U,1))}).catch(Y=>{E("error",Y)})},F=()=>C(r.item);return ne(()=>r.item.text,O),(N,Y)=>{const U=Le("tooltip");return a(),y("div",Gi,[o(se,{responsive:!1,class:"justify-between"},{default:n(()=>[o(se,{responsive:!1},{default:n(()=>[o(nt,{name:e.item.user.name,size:"sm",class:"cursor-default"},null,8,["name"]),h("div",null,u(e.item.user.name),1)]),_:1}),h("div",null,[o(zt,{class:re(["visible",{"group-hover:invisible":e.item.user.id===l(m).id||l(k)}])},{default:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1},8,["class"]),e.item.user.id===l(m).id||l(k)?(a(),y("div",Ki,[o(De,{"width-classes":"w-36",placement:"bottom-end"},{trigger:n(()=>[o(Ws)]),content:n(()=>[e.item.user.id===l(m).id?(a(),S(we,{key:0,onClick:x,as:"button",size:"xs"},{icon:n(()=>[o(Et)]),default:n(()=>[L(" "+u(l(s)("general.edit")),1)]),_:1})):I("",!0),e.item.user.id===l(m).id||l(k)?(a(),S(we,{key:1,onClick:B,as:"button",size:"xs"},{icon:n(()=>[o(Ot,{class:"text-red-500"})]),default:n(()=>[L(" "+u(l(s)("general.delete")),1)]),_:1})):I("",!0)]),_:1})])):I("",!0)])]),_:1}),h("div",Qi,[o(jt,{ref_key:"editorRef",ref:$,editable:!1,modelValue:l(b).text,"onUpdate:modelValue":Y[0]||(Y[0]=R=>l(b).text=R),onEnter:P},null,8,["modelValue"])]),o(se,{responsive:!1,class:"group/toolbar border-t border-gray-200 mt-xs pt-md items-start justify-between"},{default:n(()=>[d.value?I("",!0):(a(),y(G,{key:0},[o(se,{wrap:!0},{default:n(()=>[e.item.reactions.length?(a(!0),y(G,{key:0},oe(e.item.reactions,R=>_e((a(),y("button",{onClick:Q=>j(R.reaction),class:re([{"border-primary-500 bg-primary-100 text-primary-500 hover:bg-primary-200":R.users.some(Q=>Q.id===l(m).id)},"border border-gray-200 rounded-xl px-[6px] hover:bg-primary-100 transition-colors duration-200"])},[h("span",Xi,u(w(R.reaction)),1),h("span",er,u(R.count),1)],10,Ji)),[[U,R.users.map(Q=>Q.id===l(m).id?"Me":Q.name).join(", ")]])),256)):I("",!0),h("div",{class:re({"hidden group-hover/toolbar:block":e.item.reactions.length})},[o(st,{tooltip:l(s)("editor.add_reaction"),closeOnSelect:!0,onSelected:Y[1]||(Y[1]=R=>{j(R.unified)})},null,8,["tooltip"])],2)]),_:1}),e.isChild?I("",!0):(a(),S(ke,{key:0,onClick:F},{default:n(()=>[e.item.children_count?(a(),y("span",tr,u(l(s)("post_activity.reply_n",e.item.children_count)),1)):(a(),y("span",sr,u(l(s)("post_activity.reply")),1))]),_:1}))],64)),d.value?(a(),y(G,{key:1},[$.value&&$.value.editor?(a(),S(Ht,{key:0,editor:$.value.editor,text:l(b).text},null,8,["editor","text"])):I("",!0),o(se,null,{default:n(()=>[o(le,{onClick:Y[2]||(Y[2]=R=>{v(),g()}),disabled:l(b).processing,size:"md"},{default:n(()=>[L(u(l(s)("general.cancel")),1)]),_:1},8,["disabled"]),o(pe,{onClick:P,isLoading:l(b).processing,disabled:l(b).processing,size:"md"},{default:n(()=>[L(u(l(s)("general.save")),1)]),_:1},8,["isLoading","disabled"])]),_:1})],64)):I("",!0)]),_:1})])}}},or={class:"flex flex-col"},nr={class:"text-gray-700"},ir={key:0},Ce={__name:"TypeLayout",setup(e){return(t,s)=>(a(),y("div",or,[h("div",nr,[he(t.$slots,"default")]),t.$slots.created_at?(a(),y("div",ir,[o(zt,null,{default:n(()=>[he(t.$slots,"created_at")]),_:3})])):I("",!0)]))}},rr={__name:"ItemCreatedType",props:{item:{required:!0,type:Object}},setup(e){return(t,s)=>(a(),S(Ce,null,{default:n(()=>[L(u(t.$t("post_activity.created_post",{user:e.item.user.name})),1)]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1}))}},ar={},lr={class:"inline text-black"};function cr(e,t){return a(),y("span",lr,[he(e.$slots,"default")])}const Xe=ue(ar,[["render",cr]]),dr={__name:"ItemUpdatedScheduleTimeType",props:{item:{required:!0,type:Object}},setup(e){return(t,s)=>{const r=xt("i18n-t");return a(),S(Ce,null,{default:n(()=>[e.item.date_times.old_scheduled_at&&e.item.date_times.new_scheduled_at?(a(),S(r,{key:0,keypath:"post_activity.update_scheduled_at",tag:"div",scope:"global"},{user:n(()=>[h("span",null,u(e.item.user.name),1)]),old_datetime:n(()=>[o(Xe,null,{default:n(()=>[L(u(e.item.date_times.old_scheduled_at.localized),1)]),_:1})]),new_datetime:n(()=>[o(Xe,null,{default:n(()=>[L(u(e.item.date_times.new_scheduled_at.localized),1)]),_:1})]),_:1})):I("",!0)]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1})}}},ur={__name:"ItemScheduledType",props:{item:{required:!0,type:Object}},setup(e){const t=e,s=z(()=>t.item.data.status===Vs?"post_activity.schedule_approval":t.item.data.status===As&&t.item.data.with_approval?"post_activity.post_approved":"post_activity.scheduled_post");return(r,i)=>{const p=xt("i18n-t");return a(),S(Ce,null,{default:n(()=>[o(p,{keypath:s.value,tag:"div",scope:"global"},{user:n(()=>[h("span",null,u(e.item.user.name),1)]),datetime:n(()=>[o(Xe,null,{default:n(()=>[L(u(e.item.date_times.scheduled_at.localized),1)]),_:1})]),_:1},8,["keypath"])]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1})}}},mr={__name:"ItemPublishedType",props:{item:{required:!0,type:Object}},setup(e){return(t,s)=>(a(),S(Ce,null,{default:n(()=>[L(u(t.$t("post_activity.post_published")),1)]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1}))}},pr={__name:"ItemSetDraftType",props:{item:{required:!0,type:Object}},setup(e){return(t,s)=>(a(),S(Ce,null,{default:n(()=>[e.item.user?(a(),y(G,{key:0},[L(u(t.$t("post_activity.user_set_drafts",{user:e.item.user.name})),1)],64)):(a(),y(G,{key:1},[L(u(t.$t("post_activity.set_drafts")),1)],64))]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1}))}},vr={__name:"ItemScheduleProcessingType",props:{item:{required:!0,type:Object}},setup(e){return(t,s)=>(a(),S(Ce,null,{default:n(()=>[L(u(t.$t("post_activity.publishing")),1)]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1}))}},fr={__name:"ItemPublishedFailedType",props:{item:{required:!0,type:Object}},setup(e){return(t,s)=>(a(),S(Ce,null,{default:n(()=>[L(u(t.$t("post_activity.post_publishing_failed")),1)]),created_at:n(()=>[L(u(e.item.timestamps.localized.created_at),1)]),_:1}))}},_r={class:"row-px"},Nt={__name:"NewComment",props:{post:{required:!0,type:[Object,null]},parentId:{required:!1,type:[String,null]},view:{required:!1,type:String,default:"default"}},emits:["stored"],setup(e,{emit:t}){const{t:s}=de(),r=e,i=t,p=W(null),_=X("routePrefix"),f=X("workspaceCtx"),c=X("postCtx"),{notify:$}=be(),{addItem:m,setNewCommentText:k,getDraftCommentText:E}=Ie({context:c}),A=W(!1),M=qt({text:"",parent_id:r.parentId}),C=()=>{p.value&&p.value.editor&&p.value.editor.commands.clearContent(),T("")},T=d=>{M.text=d,k({view:r.view,text:d})},V=()=>{M.text&&r.post&&M.post(route(`${_}.posts.comments.store`,{workspace:f.id,post:r.post.id}),{onSuccess:d=>{m({view:r.view,activity:d}),i("stored",d),C()},onError:d=>{$("error",d)}})};return ae(()=>{const d=E({view:r.view});d&&(M.text=d,p.value&&p.value.editor&&(p.value.editor.commands.setContent(d),p.value.editor.commands.focus("end")))}),(d,b)=>(a(),y("div",_r,[h("div",{class:re([{"border-primary-200 ring ring-primary-200 ring-opacity-50":A.value},"border bg-white border-gray-200 rounded-lg p-md pb-xs text-base transition-colors ease-in-out duration-200"])},[o(jt,{ref_key:"editorRef",ref:p,modelValue:l(M).text,"onUpdate:modelValue":[b[0]||(b[0]=x=>l(M).text=x),T],onEnter:V,onFocus:b[1]||(b[1]=x=>A.value=!0),onBlur:b[2]||(b[2]=x=>A.value=!1)},null,8,["modelValue"]),o(se,{responsive:!1,class:"relative justify-between border-t border-gray-200 pt-xs mt-md items-center"},{default:n(()=>[p.value&&p.value.editor?(a(),S(Ht,{key:0,editor:p.value.editor,text:l(M).text},null,8,["editor","text"])):I("",!0),o(pe,{onClick:V,isLoading:l(M).processing,disabled:l(M).text===""},{default:n(()=>[L(u(l(s)("post_activity.send")),1)]),_:1},8,["isLoading","disabled"])]),_:1})],2)]))}},hr={key:0,class:"space-y-md"},gr={__name:"ViewDefault",props:{post:{required:!0,type:Object}},setup(e){de();const t=e;X("routePrefix");const s=X("workspaceCtx"),r=X("postCtx"),{notify:i}=be(),{VIEW_DEFAULT:p,getItemsCount:_,getLastScrollPosition:f,setLastScrollPosition:c,fetchDefaultItems:$}=Ie({context:r}),m=W(null),{scrollPosition:k,setScrollPosition:E,scrollToBottom:A,isNearBottom:M}=Rt(m),C=$t({COMMENT:Je,CREATED:rr,SET_DRAFT:pr,UPDATED_SCHEDULE_TIME:dr,SCHEDULED:ur,SCHEDULE_PROCESSING:vr,PUBLISHED:mr,PUBLISHED_FAILED:fr}),T=async()=>{me.start(),await $({workspace:s.id,post:t.post.id}).then(()=>{setTimeout(()=>{ce(A)},0)}).catch(V=>{i("error",V)}).finally(()=>{me.done()})};return ae(()=>{const V=f({view:p}),d=_({view:p});ve.on("postActivityCreated",()=>{M()&&ce(A)}),d||T(),V!==null&&setTimeout(()=>{ce(()=>E(V))},0),V===null&&d&&setTimeout(()=>{ce(A)},0)}),Ee(()=>{c({view:p,state:k.value}),ve.off("postActivityCreated")}),(V,d)=>(a(),y(G,null,[h("div",{ref_key:"listRef",ref:m,class:"flex flex-col h-full overflow-y-scroll mixpost-scroll-style row-px row-pt pr-1 sm:!pr-4 lg:!pr-6 pb-md"},[l(r).activity[l(p)].items.length?(a(),y("ul",hr,[(a(!0),y(G,null,oe(l(r).activity[l(p)].items,b=>(a(),y("li",{key:b.id},[(a(),S(Jt(C.value[b.type]),{item:b,postId:e.post.id},null,8,["item","postId"]))]))),128))])):I("",!0)],512),o(Nt,{view:"default",post:e.post,onStored:d[0]||(d[0]=()=>{ce(()=>{l(A)()})})},null,8,["post"])],64))}},yr=(e=250)=>{const t=W(!1);let s=null;return{isLoadingPreloader:t,startPreloader:()=>{s=setTimeout(()=>{t.value=!0},e)},stopPreloader:()=>{s&&clearTimeout(s),t.value=!1}}},kr={class:"row-px py-sm border-b border-gray-200"},$r={class:"font-medium"},wr={key:0,class:"flex items-center my-md after:content-[''] after:flex-1 after:h-[1px] after:bg-gray-200"},br={key:1,class:"space-y-md"},xr={__name:"ViewThread",props:{post:{required:!0,type:Object}},setup(e){const{t}=de(),s=e;X("routePrefix");const r=X("workspaceCtx"),i=X("postCtx"),{notify:p}=be(),{VIEW_DEFAULT:_,VIEW_THREAD:f,threadParentComment:c,getItemsCount:$,getLastScrollPosition:m,setLastScrollPosition:k,destroyThread:E,getItem:A,fetchThreadItems:M}=Ie({context:i}),{isLoadingPreloader:C,startPreloader:T,stopPreloader:V}=yr(),d=W(null),{scrollPosition:b,setScrollPosition:x,scrollToBottom:v,isNearBottom:O}=Rt(d),g=z(()=>$({view:f})),w=async()=>{c.value&&(T(),me.start(),await M({workspace:r.id,post:s.post.id,activity:c.value.id}).then(()=>{setTimeout(()=>{ce(v)},0)}).catch(j=>{p("error",j)}).finally(()=>{me.done(),V()}))};ae(()=>{const j=m({view:f}),F=$({view:f});ve.on("postActivityCreated",()=>{O()&&ce(v)}),F||w(),j!==null&&setTimeout(()=>{ce(()=>x(j))},0),j===null&&F&&setTimeout(()=>{ce(v)},0)}),Ee(()=>{k({view:f,state:b.value}),ve.off("postActivityCreated")});const P=()=>E(),B=()=>{if(!c.value)return;const j=A({view:_,id:c.value.id});j&&(j.children_count=g.value)};return(j,F)=>(a(),y(G,null,[h("div",kr,[o(se,null,{default:n(()=>[o(ke,{onClick:P,class:"mr-xl"},{default:n(()=>[o(so)]),_:1}),o(se,{class:"items-center"},{default:n(()=>[h("span",$r,u(l(t)("post_activity.thread_by")),1),o(se,{responsive:!1},{default:n(()=>[o(nt,{name:l(c).user.name,size:"xs",class:"cursor-default"},null,8,["name"]),h("div",null,u(l(c).user.name),1)]),_:1})]),_:1})]),_:1})]),h("div",{ref_key:"listRef",ref:d,class:"relative flex flex-col h-full overflow-y-scroll mixpost-scroll-style row-px row-pt pr-1 sm:!pr-4 lg:!pr-6 pb-md"},[o(Xt,null,{default:n(()=>[l(C)?(a(),S(Fe,{key:0,opacity:50})):I("",!0)]),_:1}),o(Je,{item:l(c),postId:e.post.id,isChild:!0,onDelete:P},null,8,["item","postId"]),g.value?(a(),y("div",wr,u(l(t)("post_activity.reply_n",g.value)),1)):I("",!0),l(i).activity[l(f)].items.length?(a(),y("ul",br,[(a(!0),y(G,null,oe(l(i).activity[l(f)].items,N=>(a(),y("li",{key:N.id},[o(Je,{item:N,postId:e.post.id,isChild:!0},null,8,["item","postId"])]))),128))])):I("",!0)],512),o(Nt,{view:"thread",post:e.post,parentId:l(c).id,onStored:F[0]||(F[0]=()=>{B(),ce(()=>{l(v)()})})},null,8,["post","parentId"])],64))}},Cr={class:"flex flex-col h-full"},Tr={__name:"PostActivity",props:{post:{required:!0,type:Object}},setup(e){const t=X("postCtx"),s=z(()=>t.activity.thread.parent_comment!==null);return(r,i)=>(a(),y("div",Cr,[s.value?I("",!0):(a(),S(gr,{key:0,post:e.post},null,8,["post"])),s.value?(a(),S(xr,{key:1,post:e.post},null,8,["post"])):I("",!0)]))}},Vr={},Ar={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-6 h-6"};function Lr(e,t){return a(),y("svg",Ar,t[0]||(t[0]=[h("path",{d:"M20 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM4 19V7h6v12H4zm8 0V7h8V5l.002 14H12z"},null,-1),h("path",{d:"M6 10h2v2H6zm0 4h2v2H6z"},null,-1)]))}const Er=ue(Vr,[["render",Lr]]),Ir={},Pr={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"};function Sr(e,t){return a(),y("svg",Pr,t[0]||(t[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"},null,-1)]))}const yt=ue(Ir,[["render",Sr]]),Mr={},Ur={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"};function Dr(e,t){return a(),y("svg",Ur,t[0]||(t[0]=[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.143 17.082a24.248 24.248 0 0 0 3.844.148m-3.844-.148a23.856 23.856 0 0 1-5.455-1.31 8.964 8.964 0 0 0 2.3-5.542m3.155 6.852a3 3 0 0 0 5.667 1.97m1.965-2.277L21 21m-4.225-4.225a23.81 23.81 0 0 0 3.536-1.003A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6.53 6.53m10.245 10.245L6.53 6.53M3 3l3.53 3.53"},null,-1)]))}const Or=ue(Mr,[["render",Dr]]),Fr={class:"absolute right-0 top-0 mt-sm mr-sm md:mr-xl"},Br={class:"text-sm"},qr={class:"text-sm"},Rr={__name:"Subscription",setup(e){const t=X("workspaceCtx");return(s,r)=>(a(),y("div",Fr,[o(De,{"width-classes":"w-96",placement:"bottom-end","closeable-on-content":!1},{trigger:n(()=>[o(ke,{disabled:s.$page.props.post===null,class:re({"text-primary-500":s.$page.props.has_activities_ns})},{default:n(()=>[o(yt)]),_:1},8,["disabled","class"])]),content:n(()=>[o(we,{href:s.route("mixpost.posts.activities.subscribe",{workspace:l(t).id,post:s.$page.props.post.id}),linkMethod:"post",linkAs:"button",isActive:s.$page.props.has_activities_ns===!0},{icon:n(()=>[o(yt)]),default:n(()=>[o(se,{col:!0,class:"items-start text-left"},{default:n(()=>[h("span",null,u(s.$t("post_activity.watch")),1),h("span",Br,u(s.$t("post_activity.notify_all_activity")),1)]),_:1})]),_:1},8,["href","isActive"]),o(Pt),o(we,{href:s.route("mixpost.posts.activities.unsubscribe",{workspace:l(t).id,post:s.$page.props.post.id}),linkMethod:"delete",linkAs:"button",isActive:!s.$page.props.has_activities_ns},{icon:n(()=>[o(Or)]),default:n(()=>[o(se,{col:!0,class:"items-start text-left"},{default:n(()=>[h("span",null,u(s.$t("post_activity.unwatch")),1),h("span",qr,u(s.$t("post_activity.notify_mentions_only")),1)]),_:1})]),_:1},8,["href","isActive"])]),_:1})]))}},zr={class:"flex flex-col grow h-full overflow-y-auto"},jr={class:"flex flex-row h-full overflow-y-auto"},Hr={class:"w-full h-full flex flex-col overflow-x-hidden overflow-y-auto"},Nr={class:"flex flex-col h-full"},Wr={class:"row-py h-full overflow-y-auto"},Yr={key:0,class:"flex items-center"},Zr={key:0},Gr={key:1},Kr={class:"w-full m-container mx-auto row-px"},Qr={class:"flex pb-md flex-col h-full"},Jr={class:"flex flex-col h-full"},Xr={class:"row-px pt-md relative border-b border-gray-200"},ea={class:"flex flex-col h-full overflow-y-auto"},Wl={__name:"CreateEdit",props:["post","schedule_at","accounts","prefill"],setup(e){const t=e,s=t.post?K.cloneDeep(t.post):null,r=X("workspaceCtx"),i=es({urlMeta:{},errors:{},activity:{default:{isInitialized:!1,items:[],text:"",scrollPosition:null},thread:{isInitialized:!1,items:[],scrollPosition:null,text:"",parent_comment:null}}});ts("postCtx",i);const{isMounted:p}=oo(),_=W(!1),f=W(!1),c=W(!1),$=W(!1),m=W("preview"),k=U=>{m.value=U},{isInHistory:E,isScheduleProcessing:A,editAllowed:M}=Ue(),{versionObject:C}=ge(),{connectToBroadcast:T}=no({props:t,context:i}),{VIEW_DEFAULT:V,getInitialized:d,isThreadView:b,getThreadParentItem:x,fetchDefaultItems:v,fetchThreadItems:O}=Ie({context:i}),{notify:g}=be(),{offline:w}=io(),P=kt({accounts:s?s.accounts.map(U=>U.id):[],versions:s?s.versions:[C(0,!0,t.prefill.body,[],t.prefill.title,t.prefill.link)],tags:s?s.tags:[],date:s?s.scheduled_at.date:t.schedule_at.date,time:s?s.scheduled_at.time:t.schedule_at.time}),B=U=>{ye.post(route("mixpost.posts.store",{workspace:r.id}),U,{onSuccess(){c.value=!0,Y(),T()}})},j=U=>{f.value=!0,axios.put(route("mixpost.posts.update",{workspace:r.id,post:t.post.id}),U).then(R=>{$.value=!1,R.data.status!==t.post.status&&ye.get(route("mixpost.posts.edit",{workspace:r.id,post:t.post.id}))}).catch(R=>{if(R.response.status!==422){g("error",R),$.value=!0;return}const Q=R.response.data.errors,te=Q.hasOwnProperty("in_history")||Q.hasOwnProperty("publishing")||Q.hasOwnProperty("user_can_not_approve");te||(g("error",R),$.value=!0),te&&ye.visit(route("mixpost.posts.edit",{workspace:r.id,post:t.post.id}))}).finally(()=>{c.value=!0,f.value=!1})},F=z(()=>E.value?t.post.accounts:t.accounts.filter(U=>P.accounts.includes(U.id))),N=()=>{const U={accounts:P.accounts.slice(0),versions:P.versions.map(R=>({account_id:R.account_id,is_original:R.is_original,content:R.content.map(Q=>({body:Q.body,media:Q.media.map(te=>te.id),url:Q.url})),options:R.options})),tags:P.tags.map(R=>R.id),date:P.date,time:P.time};t.post||B(U),t.post&&j(U)},Y=()=>{ne(()=>t.post.tags,U=>{P.tags=U})};return t.post&&Y(),ne(P,K.debounce(()=>{M.value&&N()},300)),ne(w,U=>{U||t.post&&(d({view:V})&&v({workspace:r.id,post:t.post.id}),b.value&&O({workspace:r.id,post:t.post.id,activity:x().id}))}),(U,R)=>(a(),y(G,null,[o(l(Kt),{title:U.$t("post.your_post")},null,8,["title"]),h("div",zr,[h("div",jr,[h("div",Hr,[h("div",Nr,[o(zi),h("div",Wr,[o(bs,{title:U.$t("post.your_post"),class:"m-container mx-auto"},{default:n(()=>[U.$page.props.post?(a(),y("div",Yr,[o(Es,{value:U.$page.props.post.status},null,8,["value"]),h("div",{class:re(["flex items-center",{"ml-lg":c.value||$.value}])},[h("div",{class:re([{hidden:!c.value,"animate-ping":f.value,"bg-lime-500":!$.value,"bg-red-500":$.value},"w-4 h-4 mr-xs rounded-full"])},null,2),!$.value&&c.value?(a(),y("div",Zr,u(U.$t("general.saved")),1)):I("",!0),$.value?(a(),y("div",Gr,u(U.$t("error.error_saving")),1)):I("",!0)],2)])):I("",!0)]),_:1},8,["title"]),h("div",Kr,[l(E)?(a(),S(Me,{key:0,closeable:!1,class:"mb-lg"},{default:n(()=>[L(u(U.$t("post.posts_history_not_edited")),1)]),_:1})):I("",!0),l(A)?(a(),S(Me,{key:1,closeable:!1,variant:"warning",class:"mb-lg"},{default:n(()=>[L(u(U.$t("post.post_being_published")),1)]),_:1})):I("",!0),l(s)&&l(s).trashed?(a(),S(Me,{key:2,closeable:!1,variant:"warning",class:"mb-lg"},{default:n(()=>[L(u(U.$t("post.posts_in_trash_not_be_edited")),1)]),_:1})):I("",!0),o(Jn,{form:l(P),accounts:U.$page.props.accounts},null,8,["form","accounts"])])])])]),h("div",{class:re([{"translate-x-0 pb-32":_.value,"translate-x-full md:translate-x-0":!_.value},"fixed md:relative w-full md:w-[750px] h-full overflow-x-hidden overflow-y-auto flex flex-col border-l border-gray-200 bg-stone-500 transition-transform ease-in-out duration-200"])},[l(p)&&l(P).accounts.length?(a(),S(ss,{key:0,to:"#navRightButton"},[o(le,{onClick:R[0]||(R[0]=Q=>_.value=!_.value),size:"xs",class:"md:hidden"},{icon:n(()=>[o(Er)]),_:1})])):I("",!0),h("div",Qr,[h("div",Jr,[h("div",Xr,[o(Ut,null,{default:n(()=>[o(Ke,{onClick:R[1]||(R[1]=Q=>k("preview")),active:m.value==="preview"},{icon:n(()=>[o(Ns)]),default:n(()=>[L(" "+u(U.$t("post.preview")),1)]),_:1},8,["active"]),o(Ke,{onClick:R[2]||(R[2]=Q=>k("activity")),active:m.value==="activity",disabled:U.$page.props.post===null},{icon:n(()=>[o(Dt)]),default:n(()=>[L(" "+u(U.$t("post_activity.activity")),1)]),_:1},8,["active","disabled"])]),_:1}),o(Rr)]),h("div",ea,[m.value==="preview"?(a(),S(Ls,{key:0,accounts:F.value,versions:l(P).versions,class:"row-px row-pt"},null,8,["accounts","versions"])):I("",!0),m.value==="activity"&&U.$page.props.post!==null?(a(),S(Tr,{key:1,post:U.$page.props.post},null,8,["post"])):I("",!0)])])])],2)]),o(Oi,{form:l(P),hasAvailableTimes:U.$page.props.has_available_times},null,8,["form","hasAvailableTimes"])])],64))}};export{Wl as default};
