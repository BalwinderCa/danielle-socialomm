import{u as Z}from"./vue-i18n-CbxO4HOa.js";import{O as R,Z as H}from"./@inertiajs-D-tiTHlX.js";import{n as K,k as Q,g as X,j as Y,i as tt,c as q,o as T,J as et,d as st,u as at}from"./app-TmpkEByR.js";import{l as j}from"./lodash-1tNnn4nO.js";import{u as ot}from"./useSelectable-B_73QrI2.js";import{_ as lt}from"./PageHeader-5KlQKxZu.js";import{_ as S,a as it}from"./PostsFilter-Ck0mMEg2.js";import{T as rt,_ as C}from"./Tab-gMbHW_qz.js";import{_ as nt}from"./Panel-C3_mBW3b.js";import{_ as U}from"./Checkbox-CdCvF_Az.js";import{_ as c,a as z,T as mt}from"./TableCell-CdlC4-rl.js";import{_ as ut}from"./PureDangerButton-BpJxGdZl.js";import{u as dt}from"./usePostVersions-THbIEc6s.js";import{_ as ct}from"./MediaFile-CRJPtfzT.js";import{u as pt,_ as F,c as ft,b as vt,a as _t}from"./VerticallyScrollableContent-DkBe3PBg.js";import{_ as M}from"./Account-CWjN0cta.js";import{b as ht,r as B,b8 as E,k as r,y as h,z as t,E as e,J as kt,x as g,l as f,A as i,C as v,ak as n,F as O,q as I,t as gt,G as J,a as $t,p as bt,aJ as xt,f as wt,b1 as yt,w as N,u as l,aO as A}from"./@vue-DxEuNGre.js";import{_ as Ct}from"./SelectableBar-D8x0PjSm.js";import{_ as Vt}from"./Pagination-BTQBy8Tc.js";import{_ as Ot}from"./NoResult-BSD8OTcv.js";import{T as Dt}from"./Trash-CGBHVq5p.js";import"./@intlify-AYDeHhOU.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CaivEIYs.js";import"./@babel-DR_DpGdq.js";import"./qs-rEl07COy.js";import"./side-channel-BRnl5gSA.js";import"./get-intrinsic-Cc4ufvoy.js";import"./has-symbols-eVqrYdw7.js";import"./function-bind-CTBxUF5L.js";import"./has-0xLfSV6H.js";import"./call-bind-BYlQD6Li.js";import"./object-inspect-DHD9wu3Y.js";import"./nprogress-34pYfWsY.js";import"./lodash.clonedeep-DcFMYim1.js";import"./lodash.isequal-K_gfpr-R.js";/* empty css            */import"./floating-vue-BgCeCz-J.js";import"./@floating-ui-Dq8c3VDt.js";import"./vue-select-CUmyCPba.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./emoji-mart-vue-fast-DVezNdb5.js";import"./mitt-DJ65BbbF.js";import"./date-fns-tz-NX4xHF3p.js";import"./date-fns-Uop7x9nl.js";import"./pusher-js-CH5STpCs.js";import"./laravel-echo-C9ppFO4I.js";import"./Flex-55yEXw9x.js";import"./PureButtonLink-Cm9jQ4_3.js";import"./EllipsisVertical-DX5Zf3Qx.js";import"./Eye-Bm2KpbsG.js";import"./ProviderIcon-2Uv5mSMq.js";import"./SearchInput-CRc85PZ0.js";import"./ExclamationCircle-Co8IAwQh.js";import"./Variable-HdI17rBQ.js";import"./@tiptap-DlxRGiDd.js";import"./prosemirror-state-Dfkm3xtq.js";import"./prosemirror-model-C-VrLeHJ.js";import"./orderedmap-C4TimWWB.js";import"./prosemirror-transform-CNTRfHZy.js";import"./prosemirror-dropcursor-CRVdsyHs.js";import"./prosemirror-gapcursor-CIClWOe5.js";import"./prosemirror-keymap-BrtsOOc5.js";import"./w3c-keyname-DEtA-KhA.js";import"./prosemirror-view-CARpBv5D.js";import"./prosemirror-history-C8_5KGmB.js";import"./rope-sequence-Cxv9J64N.js";import"./linkifyjs-CkylhtGF.js";import"./prosemirror-commands-B8A7CEu7.js";import"./prosemirror-schema-list-B_jBki9Q.js";import"./EditorReadOnly-D6nehAZB.js";import"./Alert-L3YQLqcy.js";import"./Refresh-BG68H2OY.js";import"./ArrowTopRightOnSquare-BBcEejN-.js";import"./ColorPicker-BvnLA0ov.js";import"./@jaames-DqG6q-J1.js";import"./ChevronLeft-Cx_QtWsr.js";const It={class:"w-44"},Pt={key:0,class:"text-sm mt-xs text-gray-500"},jt={key:1,class:"text-sm mt-xs text-gray-500"},Bt={class:"w-96 text-left break-words"},Rt={key:0,class:"w-48 flex relative"},Tt={key:0,class:"absolute top-0 -right-5 z-10"},St={class:"flex flex-wrap gap-xs"},Ut={class:"flex gap-xs"},Ft={class:"mr-xs"},Mt={class:"text-left"},Nt={class:"mr-xs flex items-center"},At={__name:"PostItem",props:{item:{type:Object,required:!0},filter:{type:Object,default:{accounts:[]}}},setup(a){const s=a,{getOriginalVersion:$,getAccountVersion:d}=dt(),{setupURLMetaForAllVersions:P}=pt(),p=ht(()=>{if(!s.item.versions.length)return{excerpt:"",media:null,media_count:0};let b=s.item.accounts;s.filter.accounts.length&&(b=b.filter(m=>s.filter.accounts.includes(m.id)));const V=b.map(m=>{const k=d(s.item.versions,m.id);return k?k.content[0]:$(s.item.versions).content[0]}),x=V.length?V[0]:s.item.versions[0].content[0];return{excerpt:x.excerpt,media:x.media.length?x.media[0]:null,media_count:x.media.length}}),w=B(!1),y=()=>{w.value=!0,P(s.item.versions)},D=()=>{w.value=!1};return(b,V)=>{const x=E("tooltip");return r(),h(z,{hoverable:!0},{default:t(()=>[e(c,{class:"w-10"},{default:t(()=>[kt(b.$slots,"checkbox")]),_:3}),e(c,{clickable:!0,onClick:y},{default:t(()=>[g("div",It,[e(F,{value:a.item.status},null,8,["value"]),a.item.status==="scheduled"||a.item.status==="needs_approval"?(r(),f("div",Pt,i(a.item.scheduled_at.human),1)):v("",!0),a.item.status==="published"?(r(),f("div",jt,i(a.item.published_at.human),1)):v("",!0)])]),_:1}),e(c,{clickable:!0,onClick:y,class:"!pl-0"},{default:t(()=>[g("div",Bt,i(p.value.excerpt),1)]),_:1}),e(c,{clickable:!0,onClick:y},{default:t(()=>[p.value.media?(r(),f("div",Rt,[p.value.media?(r(),h(ct,{key:0,media:p.value.media,"img-height":"sm",imgWidthFull:!1,showCaption:!1},{default:t(()=>[p.value.media_count>1?(r(),f("div",Tt,[e(K,null,{default:t(()=>[n("+"+i(p.value.media_count-1),1)]),_:1})])):v("",!0)]),_:1},8,["media"])):v("",!0)])):v("",!0)]),_:1}),e(c,{clickable:!0,onClick:y},{default:t(()=>[g("div",St,[(r(!0),f(O,null,I(a.item.tags,m=>(r(),h(ft,{key:m.id,item:m,removable:!1,editable:!1},null,8,["item"]))),128))])]),_:1}),e(c,null,{default:t(()=>[g("div",Ut,[(r(!0),f(O,null,I(a.item.accounts.slice(0,3),(m,k)=>(r(),f("div",{key:m.id,class:gt({"-ml-6":k>0})},[J(e(M,{provider:m.provider,name:m.name,"img-url":m.image,active:!0},null,8,["provider","name","img-url"]),[[x,m.name]])],2))),128)),a.item.accounts.length>3?(r(),h(Q,{key:0,"width-classes":"w-64",placement:"bottom-end"},{trigger:t(()=>[e(X,{class:"mt-4 font-semibold"},{default:t(()=>[n("+"+i(a.item.accounts.slice(3).length),1)]),_:1})]),content:t(()=>[e(vt,null,{default:t(()=>[(r(!0),f(O,null,I(a.item.accounts.slice(3),m=>(r(),h(Y,{as:"div"},{default:t(()=>[g("span",Ft,[e(M,{provider:m.provider,name:m.name,"img-url":m.image,active:!0},null,8,["provider","name","img-url"])]),g("span",Mt,i(m.name),1)]),_:2},1024))),256))]),_:1})]),_:1})):v("",!0)])]),_:1}),e(c,{align:"right"},{default:t(()=>[e(S,{itemId:a.item.id,trashed:a.item.trashed,class:"flex justify-end"},null,8,["itemId","trashed"])]),_:1}),e(tt,{show:w.value,scrollableBody:!0,onClose:D},{body:t(()=>[e(F,{value:a.item.status,class:"mb-lg"},null,8,["value"]),w.value?(r(),h(_t,{key:0,accounts:a.item.accounts,versions:a.item.versions},null,8,["accounts","versions"])):v("",!0)]),footer:t(()=>[w.value?(r(),f(O,{key:0},[g("div",Nt,[e(S,{itemId:a.item.id,trashed:a.item.trashed},null,8,["itemId","trashed"])]),e(q,{onClick:D},{default:t(()=>[n(i(b.$t("general.close")),1)]),_:1})],64)):v("",!0)]),_:1},8,["show"])]),_:3})}}},qt={class:"row-py"},zt={class:"w-full row-px"},Et={class:"w-full row-px mt-lg"},Jt={key:0,class:"mt-lg"},fs={__name:"Index",props:{filter:{type:Object,default:{}},posts:{type:Object},has_failed_posts:{type:Boolean,default:!1},has_needs_approval_posts:{type:Boolean,default:!1}},setup(a){const{t:s}=Z(),$=a,d=B({keyword:$.filter.keyword,status:$.filter.status,tags:$.filter.tags,accounts:$.filter.accounts}),P=$t({urlMeta:{}});bt("postCtx",P);const{selectedRecords:p,putPageRecords:w,toggleSelectRecordsOnPage:y,deselectRecord:D,deselectAllRecords:b}=ot(),V=xt("workspaceCtx"),x=()=>$.posts.data.map(_=>_.id);wt(()=>{w(x()),T.on("postDelete",_=>{D(_)})}),yt(()=>{T.off("postDelete")}),N(()=>j.cloneDeep(d.value),j.throttle(()=>{R.get(route("mixpost.posts.index",{workspace:V.id}),j.pickBy(d.value),{preserveState:!0,only:["posts","filter"]})},300)),N(()=>$.posts.data,()=>{w(x())});const{notify:m}=at(),k=B(!1),L=()=>{R.delete(route("mixpost.posts.deleteMultiple",{workspace:V.id}),{data:{posts:p.value,status:d.value.status},onSuccess(){b(),m("success",$.filter.status==="trash"?s("post.posts_deleted"):s("post.posts_to_trash"))},onFinish(){k.value=!1}})};return(_,o)=>{const G=E("tooltip");return r(),f(O,null,[e(l(H),{title:l(s)("post.posts")},null,8,["title"]),g("div",qt,[e(lt,{title:l(s)("post.posts")},{default:t(()=>[e(it,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=u=>d.value=u),class:"md:ml-xs rtl:md:ml-0 rtl:md:mr-xs"},null,8,["modelValue"])]),_:1},8,["title"]),g("div",zt,[e(rt,null,{default:t(()=>[e(C,{onClick:o[1]||(o[1]=u=>d.value.status=null),active:!_.$page.props.filter.status},{default:t(()=>[n(i(l(s)("general.all")),1)]),_:1},8,["active"]),e(C,{onClick:o[2]||(o[2]=u=>d.value.status="draft"),active:_.$page.props.filter.status==="draft"},{default:t(()=>[n(i(l(s)("post.drafts")),1)]),_:1},8,["active"]),a.has_needs_approval_posts?(r(),h(C,{key:0,onClick:o[3]||(o[3]=u=>d.value.status="needs_approval"),active:_.$page.props.filter.status==="needs_approval"},{default:t(()=>[n(i(l(s)("post.needs_approval")),1)]),_:1},8,["active"])):v("",!0),e(C,{onClick:o[4]||(o[4]=u=>d.value.status="scheduled"),active:_.$page.props.filter.status==="scheduled"},{default:t(()=>[n(i(l(s)("post.scheduled")),1)]),_:1},8,["active"]),e(C,{onClick:o[5]||(o[5]=u=>d.value.status="published"),active:_.$page.props.filter.status==="published"},{default:t(()=>[n(i(l(s)("post.published")),1)]),_:1},8,["active"]),a.has_failed_posts?(r(),h(C,{key:1,onClick:o[6]||(o[6]=u=>d.value.status="failed"),active:_.$page.props.filter.status==="failed",class:"text-red-500"},{default:t(()=>[n(i(l(s)("post.failed")),1)]),_:1},8,["active"])):v("",!0),e(C,{onClick:o[7]||(o[7]=u=>d.value.status="trash"),active:_.$page.props.filter.status==="trash"},{default:t(()=>[n(i(l(s)("general.trash")),1)]),_:1},8,["active"])]),_:1})]),g("div",Et,[e(Ct,{count:l(p).length,onClose:l(b)},{default:t(()=>[J((r(),h(ut,{onClick:o[8]||(o[8]=u=>k.value=!0)},{default:t(()=>[e(Dt)]),_:1})),[[G,l(s)("general.delete")]])]),_:1},8,["count","onClose"]),e(nt,{"with-padding":!1},{default:t(()=>[e(mt,null,{head:t(()=>[e(z,null,{default:t(()=>[e(c,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(U,{checked:l(y),"onUpdate:checked":o[9]||(o[9]=u=>A(y)?y.value=u:null),disabled:!a.posts.meta.total},null,8,["checked","disabled"])]),_:1}),e(c,{component:"th",scope:"col",class:"w-44"},{default:t(()=>[n(i(l(s)("post.status")),1)]),_:1}),e(c,{component:"th",scope:"col",class:"!pl-0 text-left"},{default:t(()=>[n(i(l(s)("post.content")),1)]),_:1}),e(c,{component:"th",scope:"col",class:"w-48"},{default:t(()=>[n(i(l(s)("post.media")),1)]),_:1}),e(c,{component:"th",scope:"col"},{default:t(()=>[n(i(l(s)("post.labels")),1)]),_:1}),e(c,{component:"th",scope:"col"},{default:t(()=>[n(i(l(s)("post.accounts")),1)]),_:1}),e(c,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(r(!0),f(O,null,I(a.posts.data,u=>(r(),h(At,{key:u.id,item:u,filter:a.posts.filter,onOnDelete:()=>{l(D)(u.id)}},{checkbox:t(()=>[e(U,{checked:l(p),"onUpdate:checked":o[10]||(o[10]=W=>A(p)?p.value=W:null),value:u.id},null,8,["checked","value"])]),_:2},1032,["item","filter","onOnDelete"]))),128))]),_:1}),a.posts.meta.total?v("",!0):(r(),h(Ot,{key:0,withPadding:!0},{default:t(()=>[n(i(l(s)("post.no_posts_found")),1)]),_:1}))]),_:1}),a.posts.meta.links.length>3?(r(),f("div",Jt,[e(Vt,{meta:a.posts.meta,links:a.posts.links},null,8,["meta","links"])])):v("",!0)])]),e(et,{show:k.value,variant:"danger",onClose:o[12]||(o[12]=u=>k.value=!1)},{header:t(()=>[n(i(l(s)("post.delete_posts")),1)]),body:t(()=>[n(i(l(s)("post.confirmation_delete_post")),1)]),footer:t(()=>[e(q,{onClick:o[11]||(o[11]=u=>k.value=!1),class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:t(()=>[n(i(l(s)("general.cancel")),1)]),_:1}),e(st,{onClick:L},{default:t(()=>[n(i(l(s)("general.delete")),1)]),_:1})]),_:1},8,["show"])],64)}}};export{fs as default};
